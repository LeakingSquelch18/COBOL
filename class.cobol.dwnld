1                         J E S 2  J O B  L O G  --  S Y S T E M  M V S 1  --  N O D E  N 1
0
 10.48.16 JOB06784 ---- FRIDAY,    02 FEB 2024 ----
 10.48.16 JOB06784  IRR010I  USERID TRAIN05  IS ASSIGNED TO THIS JOB.
 10.48.17 JOB06784  ICH70001I TRAIN05  LAST ACCESS AT 10:46:36 ON FRIDAY, FEBRUARY 2, 2024
 10.48.17 JOB06784  $HASP373 TRAIN05I STARTED - INIT 1    - CLASS A        - SYS MVS1
 10.48.17 JOB06784  IEF403I TRAIN05I - STARTED - TIME=10.48.17
 10.48.17 JOB06784  -                                      ----TIMINGS (MINUTES)-----                          -----PAGING COUNTS----
 10.48.17 JOB06784  -STEPNAME PROCSTEP    RC   EXCP   CONN       TCB       SRB  CLOCK          SERV  WORKLOAD  PAGE  SWAP   VIO SWAPS
 10.48.17 JOB06784  -PTPCH                00    491     25  0.001620  0.000074    0.0           666  PRDBAT       0     0     0     0
 10.48.17 JOB06784  IEF404I TRAIN05I - ENDED - TIME=10.48.17
 10.48.17 JOB06784  -TRAIN05I ENDED.  NAME-MAINTEC              TOTAL TCB CPU TIME= 0.001620 TOTAL ELAPSED TIME=   0.0 SUBSYS=JES2
 10.48.17 JOB06784  $HASP395 TRAIN05I ENDED - RC=0000
0------ JES2 JOB STATISTICS ------
-  02 FEB 2024 JOB EXECUTION DATE
-           17 CARDS READ
-        4,749 SYSOUT PRINT RECORDS
-            0 SYSOUT PUNCH RECORDS
-          397 SYSOUT SPOOL KBYTES
-         0.00 MINUTES EXECUTION TIME
         1 //TRAIN05I JOB 43312,'MAINTEC',                                         JOB06784
           //             CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=&SYSUID         00020000
           //*******************************************************               00030000
           //*** I-P-O  I(NPUT)   P(ROCESS)   O(UTPUT)  ************               00040000
           //*** I - LIBRARY                          **************               00050000
           //*** P - PRINT ENTIRE LIBRARY FROM SYSUT1  TO  SYSUT2  *               00060000
           //***     PO=LIBRARY (MAX)MEMBS 200 1 RECORD FIELDS STMT*               00070000
           //*** O - SEND DATA TO "PRINT" / JES / ******************               00080000
           //*******************************************************               00090000
           IEFC653I SUBSTITUTION JCL - 43312,'MAINTEC',CLASS=A,MSGCLASS=H,MSGLEVEL=(1,1),NOTIFY=TRAIN05
         2 //PTPCH EXEC  PGM=IEBPTPCH                                              00100000
         3 //SYSPRINT DD  SYSOUT=*                                                 00110000
         4 //SYSIN    DD  *                                                        00120000
         5 //SYSUT2   DD  SYSOUT=*                                         OUTPUT  00150000
           //******  PRINT UP TO 200 MEMBERS OF A PDS                              00160000
         6 //SYSUT1  DD  DSN=TRAIN05.CLASS.COBOL,DISP=SHR                   INPUT  00170002
 ICH70001I TRAIN05  LAST ACCESS AT 10:46:36 ON FRIDAY, FEBRUARY 2, 2024
 IEFA111I TRAIN05I IS USING THE FOLLOWING JOB RELATED SETTINGS:
          SWA=BELOW,TIOT SIZE=32K,DSENQSHR=DISALLOW,GDGBIAS=JOB
 IEF236I ALLOC. FOR TRAIN05I PTPCH
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I JES2 ALLOCATED TO SYSIN
 IEF237I JES2 ALLOCATED TO SYSUT2
 IEF237I 308F ALLOCATED TO SYSUT1
 IEF142I TRAIN05I PTPCH - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   TRAIN05.TRAIN05I.JOB06784.D0000102.?         SYSOUT
 IEF285I   TRAIN05.TRAIN05I.JOB06784.D0000101.?         SYSIN
 IEF285I   TRAIN05.TRAIN05I.JOB06784.D0000103.?         SYSOUT
 IEF285I   TRAIN05.CLASS.COBOL                          KEPT
 IEF285I   VOL SER NOS= USER02.
 IEF373I STEP/PTPCH   /START 2024033.1048
 IEF032I STEP/PTPCH   /STOP  2024033.1048
         CPU:     0 HR  00 MIN  00.10 SEC    SRB:     0 HR  00 MIN  00.00 SEC
         VIRT:    68K  SYS:   252K  EXT:        0K  SYS:    12788K
         ATB- REAL:                  1056K  SLOTS:                     0K
              VIRT- ALLOC:      13M SHRD:       0M
 IEF375I  JOB/TRAIN05I/START 2024033.1048
 IEF033I  JOB/TRAIN05I/STOP  2024033.1048
         CPU:     0 HR  00 MIN  00.10 SEC    SRB:     0 HR  00 MIN  00.00 SEC
1
-PRINT/PUNCH DATA SET UTILITY                                                                      PAGE 0001
   PRINT TYPORG=PO,MAXNAME=200,MAXFLDS=1                                 00130000
   RECORD FIELD=(80)                                                     00140000
  EOF ON SYSIN
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
  END OF DATA FOR SDS OR MEMBER
1                                                                                                              PAGE 0001
 MEMBER NAME  COMMENT
 000100//********************************************************************
 000200//*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)                       *
 000300//*** I - "INSTREAM" DATA FOLLOWS DD *                               *
 000400//*** P - "PRINT"DATA FROM INDD TO OUTDD                             *
 000500//***      3 DIFFERENT PRINT FORMATS - CHAR - DUMP - HEX             *
 000600//*** O - SEND DATA TO "PRINT" / JES / *******************************
 000700//********************************************************************
1                                                                                                              PAGE 0002
 MEMBER NAME  COMMENTS
 //********************************************************************  00010000
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)                       *  00020000
 //*** I - "INSTREAM" DATA FOLLOWS DD *                               *  00030000
 //*** P - "PRINT"DATA FROM INDD TO OUTDD                             *  00040000
 //***      3 DIFFERENT PRINT FORMATS - CHAR - DUMP - HEX             *  00050000
 //*** O - SEND DATA TO "PRINT" / JES / *******************************  00060000
 //********************************************************************  00070000
1                                                                                                              PAGE 0003
 MEMBER NAME  COBOL1
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC          PIC X(80).                              00440000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
        0000-MAIN.                                                       00490000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
            OPEN INPUT DEPT-FILE                                         00720000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
                                                                         00780000
            CLOSE DEPT-FILE                                              00800000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
            DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       00980000
1                                                                                                              PAGE 0004
 MEMBER NAME  BACKUP01
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 CNN   *    CNN    IN COLUMNS 1-3                                        00100000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC          PIC X(80).                              00440000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'MY NAME WEDGIE'.                                    00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
1                                                                                                              PAGE 0005
 MEMBER NAME  BACKUP01
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
            DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       00980000
1                                                                                                              PAGE 0006
 MEMBER NAME  BACKUP02
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC          PIC X(80).                              00440000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'MY NAME WEDGIE'.                                    00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
1                                                                                                              PAGE 0007
 MEMBER NAME  BACKUP02
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
                      UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
            DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       00980000
1                                                                                                              PAGE 0008
 MEMBER NAME  COBTSTR
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE           10-23     ORIGINAL CODE                       00080000
 C1    *    C1             10-25     PERFORM PARAGRAPH                   00090003
 C2    *    C2             10-25     PEREFORM IN-LINE                    00100003
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-COUNTER           PIC 9(02)     VALUE ZERO.               00430005
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'WELCOME TO COBTSTR'.                                00471003
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
 C1         PERFORM 1000-PERFORM-PARAGRAPH                               00520011
 C2         PERFORM 2000-ADD-DISPLAY                                     00522011
            GOBACK                                                       00523009
            .                                                            00524010
 C1     1000-PERFORM-PARAGRAPH.                                          00525010
 C1    ***  PERFORM PARAGRAPH NAME                                       00530009
 C1         DISPLAY '   '                                                00540009
 C1         DISPLAY '==================================='                00540109
 C1         DISPLAY 'PERFORM PARAGRAPH NAME........'                     00540209
 C1         MOVE ZERO TO WS-COUNTER                                      00541009
 C1         PERFORM 1100-ADD-DISPLAY UNTIL WS-COUNTER > 10               00542009
 C1          .                                                           00542104
 C1     1100-ADD-DISPLAY.                                                00543009
            DISPLAY 9999                                                 00543109
1                                                                                                              PAGE 0009
 MEMBER NAME  COBTSTR
 C1         ADD 1 TO WS-COUNTER                                          00544009
 C1         DISPLAY 'WS-COUNTER = ' WS-COUNTER                           00545009
             .                                                           00546001
                                                                         00546109
 C2     2000-ADD-DISPLAY.                                                00547008
 C2    ***  PERFORM IN-LINE (THROUGH AN END-PERFORM)                     00548003
 C2         DISPLAY '   '                                                00548109
 C2         DISPLAY '==================================='                00548209
 C2         DISPLAY 'PERFORM I-N-L-I-N-E   ........'                     00548309
 C2         MOVE ZERO TO WS-COUNTER                                      00549009
 C2                                                                      00549103
 C2         PERFORM UNTIL WS-COUNTER > 10                                00549209
                DISPLAY 'IN INLINE PERFORM'                              00549309
 C2             ADD 1 TO WS-COUNTER                                      00549409
 C2             DISPLAY 'WS-COUNTER = ' WS-COUNTER                       00549509
 C2         END-PERFORM                                                  00549609
            .                                                            00580000
1                                                                                                              PAGE 0010
 MEMBER NAME  BACKUP03
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC          PIC X(80).                              00440000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'MY NAME WEDGIE'.                                    00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
1                                                                                                              PAGE 0011
 MEMBER NAME  BACKUP03
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       00980000
1                                                                                                              PAGE 0012
 MEMBER NAME  BACKUP04
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE.                        00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC          PIC X(80).                              00440000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'MY NAME WEDGIE'.                                    00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
1                                                                                                              PAGE 0013
 MEMBER NAME  BACKUP04
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721000
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00801000
 C4         DISPLAY ' '                                                  00802000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       00980000
1                                                                                                              PAGE 0014
 MEMBER NAME  BACKUP05
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5<   *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
       ***************************************************************** 00105900
       *******  PROGRAM STRUCTURE    *********************************** 00106000
       ***************************************************************** 00107000
       *** 0000-MAIN.                                                    00108000
       *** 1000-PROCESS-DEPT-FILE                                        00109000
       ***     OPEN DEPT-FILE                                            00110000
       ***         1100-PROCESS-DEPT-REC                                 00120000
       ***     CLOSE DEPT-FILE                                           00130000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00140000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00284000
        DATA DIVISION.                                                   00285000
        FILE SECTION.                                                    00286000
                                                                         00287000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00288000
        FD  DEPT-FILE                                                    00289000
            RECORD CONTAINS 80 CHARACTERS                                00290000
            BLOCK  CONTAINS  0 RECORDS                                   00300000
            RECORDING  MODE IS F.                                        00310000
        01  DEPT-REC          PIC X(80).                                 00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00380000
                                                                         00390000
        WORKING-STORAGE SECTION.                                         00400000
       ********* WS - OUR DATA NAMES *******************                 00410000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00420000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
        LINKAGE SECTION.                                                 00449900
                                                                         00450000
        PROCEDURE DIVISION.                                              00460000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
1                                                                                                              PAGE 0015
 MEMBER NAME  BACKUP05
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
       ********* GOBACK - RETURN TO Z/OS ****************                00553000
            GOBACK                                                       00554000
            .                                                            00555000
                                                                         00556000
                                                                         00557000
        1000-PROCESS-DEPT-FILE.                                          00558000
       **********************************************************        00559000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00560000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00570000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00580000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00590000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00600000
       **********************************************************        00610000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00620000
                                                                         00630000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00640000
            OPEN INPUT DEPT-FILE                                         00650000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00660000
 C4         DISPLAY ' '                                                  00670000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00680000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00690000
                                                                         00700000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00710000
            PERFORM 1100-PROCESS-DEPT-REC                                00720000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00730000
                                                                         00740000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00750000
            CLOSE DEPT-FILE                                              00760000
 C4         DISPLAY ' '                                                  00770000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00780000
            .                                                            00790000
                                                                         00800000
        1100-PROCESS-DEPT-REC.                                           00810000
       **********************************************************        00820000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00830000
       **********************************************************        00840000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'**********************        00850000
                                                                         00860000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00870000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00880000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00890000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00900000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00910000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00920000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00930000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00940000
            END-READ                                                     00950800
            .                                                            00964000
       **************END OF COBOL PROGRAM************************        00975000
1                                                                                                              PAGE 0016
 MEMBER NAME  BACKUP07
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7<   *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
       ***************************************************************** 00105900
       *******  PROGRAM STRUCTURE    *********************************** 00106000
       ***************************************************************** 00107000
       *** 0000-MAIN.                                                    00108000
       *** 1000-PROCESS-DEPT-FILE                                        00109000
       ***     OPEN DEPT-FILE                                            00110000
       ***         1100-PROCESS-DEPT-REC                                 00120000
       ***     CLOSE DEPT-FILE                                           00130000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00140000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00284000
        DATA DIVISION.                                                   00285000
        FILE SECTION.                                                    00286000
                                                                         00287000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00288000
        FD  DEPT-FILE                                                    00289000
            RECORD CONTAINS 80 CHARACTERS                                00290000
            BLOCK  CONTAINS  0 RECORDS                                   00300000
            RECORDING  MODE IS F.                                        00310000
        01  DEPT-REC          PIC X(80).                                 00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00380000
                                                                         00390000
        WORKING-STORAGE SECTION.                                         00400000
       ********* WS - OUR DATA NAMES *******************                 00410000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00420000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
        01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446000
        01  WS-EMP-REC.                                                  00448000
        LINKAGE SECTION.                                                 00449900
1                                                                                                              PAGE 0017
 MEMBER NAME  BACKUP07
                                                                         00450000
        PROCEDURE DIVISION.                                              00460000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
       ********* GOBACK - RETURN TO Z/OS ****************                00553000
            GOBACK                                                       00554000
            .                                                            00555000
                                                                         00556000
                                                                         00557000
        1000-PROCESS-DEPT-FILE.                                          00558000
       **********************************************************        00559000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00560000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00570000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00580000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00590000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00600000
       **********************************************************        00610000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00620000
                                                                         00630000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00640000
            OPEN INPUT DEPT-FILE                                         00650000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00660000
 C4         DISPLAY ' '                                                  00670000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00680000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00690000
                                                                         00700000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00710000
            PERFORM 1100-PROCESS-DEPT-REC                                00720000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00730000
                                                                         00740000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00750000
            CLOSE DEPT-FILE                                              00760000
 C4         DISPLAY ' '                                                  00770000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00780000
            .                                                            00790000
                                                                         00800000
        1100-PROCESS-DEPT-REC.                                           00810000
       **********************************************************        00820000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00830000
       **********************************************************        00840000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00850000
                                                                         00860000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00870000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00880000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00890000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00900000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00910000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00920000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00930000
1                                                                                                              PAGE 0018
 MEMBER NAME  BACKUP07
       *******DISPLAY INDIVIDUAL FIELDS********************************  00940000
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NUM='              00950000
 C6                                    WS-DEPT-REC-DEPT-NUM              00950100
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NAME='             00950200
 C6                                    WS-DEPT-REC-DEPT-NAME             00950300
 C6                         DISPLAY 'WS-DEPT-REC-MANAGER-NUM='           00950400
 C6                                    WS-DEPT-REC-MANAGER-NUM           00950500
 C6                         DISPLAY 'WS-DEPT-REC-ADMIN-CODE='            00950600
 C6                                    WS-DEPT-REC-ADMIN-CODE            00950700
            END-READ                                                     00950800
            .                                                            00964000
       ********  END OF PROGRAM    COBSHEL ***********************       01007000
1                                                                                                              PAGE 0019
 MEMBER NAME  BACKUP06
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6<   *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104001
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC          PIC X(80).                                 00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
1                                                                                                              PAGE 0020
 MEMBER NAME  BACKUP06
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721000
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NUM='              00950200
 C6                                    WS-DEPT-REC-DEPT-NUM              00950300
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NAME='             00950400
1                                                                                                              PAGE 0021
 MEMBER NAME  BACKUP06
 C6                                    WS-DEPT-REC-DEPT-NAME             00950500
 C6                         DISPLAY 'WS-DEPT-REC-MANAGER-NUM='           00950600
 C6                                    WS-DEPT-REC-MANAGER-NUM           00950700
 C6                         DISPLAY 'WS-DEPT-REC-ADMIN-CODE='            00950800
 C6                                    WS-DEPT-REC-ADMIN-CODE            00950900
            END-READ                                                     00960000
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       01010001
1                                                                                                              PAGE 0022
 MEMBER NAME  BACKUP08
        IDENTIFICATION DIVISION.                                         00010001
        PROGRAM-ID.       COBSHEL.                                       00020001
       ***************************************************************** 00030001
       ***********    CHANGE LOG   ************************************* 00040001
       *---------------------------------------------------------------* 00050001
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060001
       *---------------------------------------------------------------* 00070001
       *    NONE          10-23      ORIGINAL CODE                       00080001
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090001
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100001
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101001
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102001
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103001
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104001
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105001
 C8<   *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105101
       ***************************************************************** 00105901
       *******  PROGRAM STRUCTURE    *********************************** 00106001
       ***************************************************************** 00107001
       *** 0000-MAIN.                                                    00108001
       *** 1000-PROCESS-DEPT-FILE                                        00109001
       ***     OPEN DEPT-FILE                                            00110001
       ***         1100-PROCESS-DEPT-REC                                 00120001
       ***     CLOSE DEPT-FILE                                           00130001
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00140001
       ***************************************************************** 00200001
        ENVIRONMENT DIVISION.                                            00210001
        INPUT-OUTPUT SECTION.                                            00220001
        FILE-CONTROL.                                                    00230001
       **********************************************************        00240001
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250001
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260001
       **********************************************************        00270001
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280001
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281001
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00284001
        DATA DIVISION.                                                   00285001
        FILE SECTION.                                                    00286001
                                                                         00287001
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00288001
        FD  DEPT-FILE                                                    00289001
            RECORD CONTAINS 80 CHARACTERS                                00290001
            BLOCK  CONTAINS  0 RECORDS                                   00300001
            RECORDING  MODE IS F.                                        00310001
        01  DEPT-REC          PIC X(80).                                 00320001
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00380001
                                                                         00390001
        WORKING-STORAGE SECTION.                                         00400001
       ********* WS - OUR DATA NAMES *******************                 00410001
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00420001
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00430001
        01  WS-DEPT-REC.                                                 00440001
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441001
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442001
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443001
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444001
 C5       05                               PIC X(32).                    00445001
        LINKAGE SECTION.                                                 00449901
1                                                                                                              PAGE 0023
 MEMBER NAME  BACKUP08
                                                                         00450001
        PROCEDURE DIVISION.                                              00460001
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00470001
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480001
        0000-MAIN.                                                       00490001
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500001
            DISPLAY '0000-MAIN'                                          00510001
                                                                         00520001
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530001
            PERFORM 1000-PROCESS-DEPT-FILE                               00540001
                                                                         00550001
            PERFORM 2000-PROCESS-EMP-FILE                                00551001
                                                                         00552001
       ********* GOBACK - RETURN TO Z/OS ****************                00553001
            GOBACK                                                       00554001
            .                                                            00555001
                                                                         00556001
                                                                         00557001
        1000-PROCESS-DEPT-FILE.                                          00558001
       **********************************************************        00559001
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00560001
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00570001
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00580001
       ***      PARAGRAPH 1100- IS FINISHED                    **        00590001
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00600001
       **********************************************************        00610001
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00620001
                                                                         00630001
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00640001
            OPEN INPUT DEPT-FILE                                         00650001
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00660001
 C4         DISPLAY ' '                                                  00670001
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00680001
            MOVE SPACES  TO  WS-DEPT-EOF                                 00690001
                                                                         00700001
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00710001
            PERFORM 1100-PROCESS-DEPT-REC                                00720001
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00730001
                                                                         00740001
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00750001
            CLOSE DEPT-FILE                                              00760001
 C4         DISPLAY ' '                                                  00770001
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00780001
            .                                                            00790001
                                                                         00800001
        1100-PROCESS-DEPT-REC.                                           00810001
       **********************************************************        00820001
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00830001
       **********************************************************        00840001
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00850001
                                                                         00860001
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00870001
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00880001
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00890001
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00900001
            READ DEPT-FILE INTO  WS-DEPT-REC                             00910001
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00920001
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00930001
1                                                                                                              PAGE 0024
 MEMBER NAME  BACKUP08
       *******DISPLAY INDIVIDUAL FIELDS********************************  00940001
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NUM='              00950001
 C6                                    WS-DEPT-REC-DEPT-NUM              00950101
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NAME='             00950201
 C6                                    WS-DEPT-REC-DEPT-NAME             00950301
 C6                         DISPLAY 'WS-DEPT-REC-MANAGER-NUM='           00950401
 C6                                    WS-DEPT-REC-MANAGER-NUM           00950501
 C6                         DISPLAY 'WS-DEPT-REC-ADMIN-CODE='            00950601
 C6                                    WS-DEPT-REC-ADMIN-CODE            00950701
            END-READ                                                     00950801
            .                                                            00964001
       ********  END OF PROGRAM    COBSHEL ***********************       01007002
1                                                                                                              PAGE 0025
 MEMBER NAME  BACKUP09
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9<   *    C9            10-27      ADD FILE STATUS DISPLAY             00105200
       ***************************************************************** 00105900
       *******  PROGRAM STRUCTURE    *********************************** 00106000
       ***************************************************************** 00107000
       *** 0000-MAIN.                                                    00108000
       *** 1000-PROCESS-DEPT-FILE                                        00109000
       ***     OPEN DEPT-FILE                                            00110000
       ***         1100-PROCESS-DEPT-REC                                 00120000
       ***     CLOSE DEPT-FILE                                           00130000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00140000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00284000
        DATA DIVISION.                                                   00285000
        FILE SECTION.                                                    00286000
                                                                         00287000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00288000
        FD  DEPT-FILE                                                    00289000
            RECORD CONTAINS 80 CHARACTERS                                00290000
            BLOCK  CONTAINS  0 RECORDS                                   00300000
            RECORDING  MODE IS F.                                        00310000
        01  DEPT-REC          PIC X(80).                                 00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00380000
                                                                         00390000
        WORKING-STORAGE SECTION.                                         00400000
       ********* WS - OUR DATA NAMES *******************                 00410000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00420000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00430000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
1                                                                                                              PAGE 0026
 MEMBER NAME  BACKUP09
        LINKAGE SECTION.                                                 00449900
                                                                         00450000
        PROCEDURE DIVISION.                                              00460000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00553000
            GOBACK                                                       00554000
            .                                                            00555000
                                                                         00556000
                                                                         00557000
        1000-PROCESS-DEPT-FILE.                                          00558000
       **********************************************************        00559000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00560000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00570000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00580000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00590000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00600000
       **********************************************************        00610000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00620000
                                                                         00630000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00640000
            OPEN INPUT DEPT-FILE                                         00650000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00660000
 C4         DISPLAY ' '                                                  00670000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00680000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00690000
                                                                         00700000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00710000
            PERFORM 1100-PROCESS-DEPT-REC                                00720000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00730000
                                                                         00740000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00750000
            CLOSE DEPT-FILE                                              00760000
 C4         DISPLAY ' '                                                  00770000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00780000
            .                                                            00790000
                                                                         00800000
        1100-PROCESS-DEPT-REC.                                           00810000
       **********************************************************        00820000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00830000
       **********************************************************        00840000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00850000
                                                                         00860000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00870000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00880000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00890000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00900000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00910000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00920000
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00930000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00940000
1                                                                                                              PAGE 0027
 MEMBER NAME  BACKUP09
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NUM='              00950000
 C6                                    WS-DEPT-REC-DEPT-NUM              00950100
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NAME='             00950200
 C6                                    WS-DEPT-REC-DEPT-NAME             00950300
 C6                         DISPLAY 'WS-DEPT-REC-MANAGER-NUM='           00950400
 C6                                    WS-DEPT-REC-MANAGER-NUM           00950500
 C6                         DISPLAY 'WS-DEPT-REC-ADMIN-CODE='            00950600
 C6                                    WS-DEPT-REC-ADMIN-CODE            00950700
            END-READ                                                     00950800
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00950900
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00951000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00952000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00953000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00954000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00955000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00956000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00957000
 C9               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    00958000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00959000
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00960000
 C9               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 00961000
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00962000
 C9             END-EVALUATE                                             00963000
            .                                                            00964000
       ********  END OF PROGRAM    COBSHEL ***********************       01007000
1                                                                                                              PAGE 0028
 MEMBER NAME  BACKUP10
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY             00105200
 C10<  *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00105300
       ***************************************************************** 00105900
       *******  PROGRAM STRUCTURE    *********************************** 00106000
       ***************************************************************** 00107000
       *** 0000-MAIN.                                                    00108000
       *** 1000-PROCESS-DEPT-FILE                                        00109000
       ***     OPEN DEPT-FILE                                            00110000
       ***         1100-PROCESS-DEPT-REC                                 00120000
       ***     CLOSE DEPT-FILE                                           00130000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00140000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE  ASSIGN TO DEPTFILE                         00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
 C10        SELECT EMP-FILE  ASSIGN TO EMPFILE                           00282000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00284000
        DATA DIVISION.                                                   00285000
        FILE SECTION.                                                    00286000
                                                                         00287000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00288000
        FD  DEPT-FILE                                                    00289000
            RECORD CONTAINS 80 CHARACTERS                                00290000
            BLOCK  CONTAINS  0 RECORDS                                   00300000
            RECORDING  MODE IS F.                                        00310000
        01  DEPT-REC          PIC X(80).                                 00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00380000
                                                                         00390000
        WORKING-STORAGE SECTION.                                         00400000
       ********* WS - OUR DATA NAMES *******************                 00410000
        01  WS-DEPT-EOF                    PIC X(03)   VALUE SPACES.     00420000
 C8     01  WS-DEPT-FILE-STATUS            PIC X(02).                    00430000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
1                                                                                                              PAGE 0029
 MEMBER NAME  BACKUP10
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
        LINKAGE SECTION.                                                 00449900
                                                                         00450000
        PROCEDURE DIVISION.                                              00460000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00470000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
       ********* GOBACK - RETURN TO Z/OS ****************                00553000
            GOBACK                                                       00554000
            .                                                            00555000
                                                                         00556000
                                                                         00557000
        1000-PROCESS-DEPT-FILE.                                          00558000
       **********************************************************        00559000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00560000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00570000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00580000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00590000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00600000
       **********************************************************        00610000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00620000
                                                                         00630000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00640000
            OPEN INPUT DEPT-FILE                                         00650000
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00660000
 C4         DISPLAY ' '                                                  00670000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00680000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00690000
                                                                         00700000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00710000
            PERFORM 1100-PROCESS-DEPT-REC                                00720000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00730000
                                                                         00740000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00750000
            CLOSE DEPT-FILE                                              00760000
 C4         DISPLAY ' '                                                  00770000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00780000
            .                                                            00790000
                                                                         00800000
        1100-PROCESS-DEPT-REC.                                           00810000
       **********************************************************        00820000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00830000
       **********************************************************        00840000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00850000
                                                                         00860000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00870000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00880000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00890000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00900000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00910000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00920000
1                                                                                                              PAGE 0030
 MEMBER NAME  BACKUP10
                NOT AT END  DISPLAY 'WS-DEPT-REC ='  WS-DEPT-REC         00930000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00940000
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NUM='              00950000
 C6                                    WS-DEPT-REC-DEPT-NUM              00950100
 C6                         DISPLAY 'WS-DEPT-REC-DEPT-NAME='             00950200
 C6                                    WS-DEPT-REC-DEPT-NAME             00950300
 C6                         DISPLAY 'WS-DEPT-REC-MANAGER-NUM='           00950400
 C6                                    WS-DEPT-REC-MANAGER-NUM           00950500
 C6                         DISPLAY 'WS-DEPT-REC-ADMIN-CODE='            00950600
 C6                                    WS-DEPT-REC-ADMIN-CODE            00950700
            END-READ                                                     00950800
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00950900
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00951000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00952000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00953000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00954000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00955000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00956000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00957000
 C9               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    00958000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00959000
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00960000
 C9               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 00961000
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00962000
 C9             END-EVALUATE                                             00963000
            .                                                            00964000
       ********  END OF PROGRAM    COBSHEL ***********************       01007000
1                                                                                                              PAGE 0031
 MEMBER NAME  COBTSTR2
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE           10-23     ORIGINAL CODE                       00080000
 C1    *    C1             10-30     P 66  IF                            00090000
 C2    *    C2             10-30     P 66  EVAL                          00100000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
        ENVIRONMENT DIVISION.                                            00140000
        INPUT-OUTPUT SECTION.                                            00150000
        FILE-CONTROL.                                                    00160000
       **********************************************************        00170000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00180000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00190000
       **********************************************************        00200000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00210000
        DATA DIVISION.                                                   00220000
        FILE SECTION.                                                    00230000
                                                                         00240000
        WORKING-STORAGE SECTION.                                         00260000
       ********* WS - OUR DATA NAMES *******************                 00270000
        01  WS-CODE-X                   PIC X(02).                       00280000
        LINKAGE SECTION.                                                 00290000
                                                                         00300000
        PROCEDURE DIVISION.                                              00310000
 C1         DISPLAY 'WELCOME TO COBTSTR'.                                00320000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00330000
        0000-MAIN.                                                       00340000
            DISPLAY '0000-MAIN'                                          00340100
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00350000
 C1         MOVE 1 TO WS-CODE-X                                          00370000
 C1         PERFORM 1000-IF                                              00380000
 C1         MOVE 2 TO WS-CODE-X                                          00390000
 C1         PERFORM 1000-IF                                              00400000
 C1         MOVE 3 TO WS-CODE-X                                          00410000
 C1         PERFORM 1000-IF                                              00420000
                                                                         00430000
 C2         MOVE 1 TO WS-CODE-X                                          00440000
 C2         PERFORM 2000-EVAL                                            00450000
 C2         MOVE 2 TO WS-CODE-X                                          00460000
 C2         PERFORM 2000-EVAL                                            00470000
 C2         MOVE 3 TO WS-CODE-X                                          00480000
 C2         PERFORM 2000-EVAL                                            00490000
                                                                         00491000
            GOBACK                                                       00500000
            .                                                            00510000
 C1     1000-IF.                                                         00520000
 C1         DISPLAY '1000-IF ---------------------------------'          00530000
 C1         IF WS-CODE-X = '1'                                           00540000
 C1            DISPLAY 'WS-CODE-X = 1'                                   00550000
 C1         ELSE IF WS-CODE-X = '2'                                      00560000
 C1                 DISPLAY 'WS-CODE-X = 2'                              00570000
 C1              ELSE DISPLAY 'WS-CODE-X IS NOT (1 OR 2)'                00580000
1                                                                                                              PAGE 0032
 MEMBER NAME  COBTSTR2
 C1              END-IF                                                  00590000
 C1         END-IF                                                       00600000
 C1         .                                                            00610000
                                                                         00620000
 C2     2000-EVAL.                                                       00630000
 C2         DISPLAY '2000-EVAL -------------------------------'          00640000
 C2         EVALUATE WS-CODE-X                                           00650000
 C2            WHEN '1'   DISPLAY 'WS-CODE-X = 1'                        00660000
 C2            WHEN '2'   DISPLAY 'WS-CODE-X = 2'                        00670000
 C2            WHEN OTHER DISPLAY 'WS-CODE-X IS NOT (1 OR 2)'            00680000
 C2         END-EVALUATE                                                 00690000
            .                                                            00700000
1                                                                                                              PAGE 0033
 MEMBER NAME  COBTSTS3
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE           10-23     ORIGINAL CODE                       00080000
 C1    *    C1             10-31     P 81  MOVE TO EDIT PCIS             00090000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
        ENVIRONMENT DIVISION.                                            00140000
        INPUT-OUTPUT SECTION.                                            00150000
        FILE-CONTROL.                                                    00160000
       **********************************************************        00170000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00180000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00190000
       **********************************************************        00200000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00210000
        DATA DIVISION.                                                   00220000
        FILE SECTION.                                                    00230000
                                                                         00240000
        WORKING-STORAGE SECTION.                                         00260000
       ********* WS - OUR DATA NAMES *******************                 00270000
        01  WS-DOLLAR-N-CENTS           PIC $9,9Z9.99.                   00280000
        01  WS-FIX-DOLLAR               PIC $Z,ZZZ.99.                   00280100
        01  WS-FLT-DOLLAR               PIC $$,$$$.99.                   00281000
        LINKAGE SECTION.                                                 00290000
                                                                         00300000
        PROCEDURE DIVISION.                                              00310000
 C1         DISPLAY 'WELCOME TO COBTSTR'.                                00320000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00330000
        0000-MAIN.                                                       00340000
            DISPLAY '0000-MAIN'                                          00340100
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00350000
            MOVE  123.45    TO  WS-DOLLAR-N-CENTS                        00360000
            DISPLAY            'WS-DOLLAR-N-CENTS='                      00361000
                                WS-DOLLAR-N-CENTS                        00362000
            MOVE  123.45    TO  WS-FIX-DOLLAR                            00370000
            DISPLAY             'WS-FIX-DOLLAR   ='                      00371000
                                WS-FIX-DOLLAR                            00372000
            MOVE  123.45    TO  WS-FLT-DOLLAR                            00380000
            DISPLAY             'WS-FLT-DOLLAR   ='                      00390000
                                WS-FLT-DOLLAR                            00400000
            GOBACK                                                       00500000
            .                                                            00510000
1                                                                                                              PAGE 0034
 MEMBER NAME  INDEX
 000100COBCLG    COMPILE LINK GO(RUN)
 000200COBSHEL   WORKINF PROGRAM
 000300BACKUP01  C1 BACKUP TO COBSHEL ADD DISPLAY COMMAND
 000400BACKUP02  C2 BACKUP TO COBSHELL LOOP DEPT PRINT
 000500BACKUP03  C3 COMMENT OUT DISPLAY 1100
 000600BACKUP04  C4 DISPLAY START/END DEPT FILE
 000800BACKUP05  C5 ADD INDIVIDUAL FIELDS OF WHOLE REC
 000900BACKUP06  C6 ADD DISPLAY OF INDIVIDUAL FIELDS
 001000BACKUP07  C7 ADD FILE STATUS DEFINITION
 001100BACKUP08  C8 ADD FILE STATUS TO WORKING STORAGE
 001200BACKUP09  C9 ADD FILE STATUS DISPLAY: O,R,C
 001300BACKUP10  C10 ASIGN EMPFILE TO EMP-FILE
 001400BACKUP11  C11 ADD EMP-FILE STATUS DEFINITION
 001500BACKUP12  C12 DEFINE EMP FILE
 001600BACKUP13  C13 DEFINE EMP FILE STATUS CHAR LENGHT
 001700BACKUP14  C14 ADD EMP INDIVIDUAL FIELDS
 001800BACKUP15  C15 REPEAT DEPTFILE AS EMP FILE PROCESS
 001900BACKUP16  C16 MOVE END READ DISPLAY TO 1110
 002000BACKUP17  C17 DEPTFILE EDIT BLANKS
 003500BACKUP18  C18 EMPFILE EDIT BLANKS
 003600BACKUP19  C19 PROCESS TRANS-FILE
1                                                                                                              PAGE 0035
 MEMBER NAME  COBCLGTS
 //TRAIN05X JOB 43312,'MAINTEC',
 //             CLASS=A,MSGCLASS=X,MSGLEVEL=(1,1),NOTIFY=&SYSUID
 //JOBPROC JCLLIB ORDER=TRAIN00.CLASS.COBOL
 //COBCL   EXEC IGYWCL,
 //             PGMLIB=TRAIN05.CLASS.LOADLIB,      --> LOADLIB NAME
 //             COPYLIB=TRAIN05.CLASS.COBOL,       --> COPYLIB NAME
 //             GOPGM=COBSHEL                       --> MEMBER NAME
 //COBOL.SYSIN DD DSN=TRAIN05.CLASS.COBOL(COBTSTR),DISP=SHR   -->SRC
 //**********************************************************
 //RUN     EXEC PGM=COBSHEL,COND=(5,LT)             --> MEMBER NAME
 //STEPLIB   DD DSN=TRAIN05.CLASS.LOADLIB,DISP=SHR -> LOADLIB NAME
 //SYSOUT    DD SYSOUT=*,OUTLIM=200
 //DEPTFILE  DD DSN=TRAIN00.CLASS.DEPTFILE,DISP=SHR
1                                                                                                              PAGE 0036
 MEMBER NAME  BACKUP11
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106000
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107000
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       *** 2000-PROCESS-EMP-FILE                                         00191000
       ***     OPEN EMP-FILE                                             00192000
       ***         2100-PROCESS-EMP-REC                                  00193000
       ***     CLOSE EMP-FILE                                            00194000
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195000
       *** 3000-PROCESS-TRANS-FILE                                       00196000
       ***     OPEN TRANS-FILE                                           00197000
       ***         3100-PROCESS-TRANS-REC                                00198000
       ***     CLOSE TRANS-FILE                                          00199000
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199100
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282000
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
1                                                                                                              PAGE 0037
 MEMBER NAME  BACKUP11
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC         PIC X(80).                                  00380000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
        LINKAGE SECTION.                                                 00452000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
            PERFORM 3000-PROCESS-TRANS-FILE                              00553000
                                                                         00554000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720100
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720200
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720400
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720500
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720600
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720700
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720800
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721300
 C9             END-EVALUATE                                             00721400
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721500
 C4         DISPLAY ' '                                                  00722000
1                                                                                                              PAGE 0038
 MEMBER NAME  BACKUP11
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809100
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809200
 C9             END-EVALUATE                                             00809300
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
            END-READ                                                     00960000
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969100
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969200
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969400
 C9         END-EVALUATE                                                 00969500
            .                                                            00970000
       ********  END OF PROGRAM    COBSHEL ***********************       01090000
1                                                                                                              PAGE 0039
 MEMBER NAME  BACKUP21
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106000
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107000
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108000
 C12   *    C12           10-27      DEFINE EMP FILE                     00109000
 C13   *    C13           10-27      DEFINE EMP FILE STATUS CHAR LENGHT  00109100
 C14   *    C14           10-27      ADD EMP INDIVIDUAL FIELDS           00109200
 C15   *    C15           10-27      REPEAT DEPTFILE AS EMP FILE PROCESS 00109300
 C16   *    C16           10-27      MOVE END READ DISPLAY TO 1110       00109400
 C17   *    C17           10-30      DEPTFILE EDIT BLANKS                00109500
 C18   *    C18           10-31      EMPFILE EDIT BLANKS                 00109600
 C19   *    C19           11-01      PROCESS TRANS-FILE IF STATEMENT     00109700
 C20   *    C20           11-01      PROCESS TRANS-FILE EVALUATE         00109800
 C21   *    C21           11-08      EMP PRINT FILE                      00109900
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       *** 2000-PROCESS-EMP-FILE                                         00191000
       ***     OPEN EMP-FILE                                             00192000
       ***         2100-PROCESS-EMP-REC                                  00193000
       ***     CLOSE EMP-FILE                                            00194000
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195000
       *** 3000-PROCESS-TRANS-FILE                                       00196000
       ***     OPEN TRANS-FILE                                           00197000
       ***         3100-PROCESS-TRANS-REC                                00198000
       ***     CLOSE TRANS-FILE                                          00199000
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199100
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
1                                                                                                              PAGE 0040
 MEMBER NAME  BACKUP21
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282000
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283000
 C21        SELECT EMP-PRT-FILE ASSIGN TO PRINTEMP                       00284000
 C21              FILE STATUS IS WS-EMP-PRT-FILE-STATUS.                 00285000
 C19        SELECT TRANS-FILE   ASSIGN TO TRANS                          00286000
 C19              FILE STATUS IS WS-TRANS-FILE-STATUS.                   00287000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC         PIC X(80).                                  00380000
 C12    FD  EMP-FILE                                                     00381000
 C12        RECORD CONTAINS 80 CHARACTERS                                00382000
 C12        BLOCK  CONTAINS  0 RECORDS                                   00383000
 C12        RECORDING  MODE IS F.                                        00384000
 C12    01  EMP-REC          PIC X(80).                                  00385000
 C22    FD  EMP-PRT-FILE                                                 00385101
 C22        RECORD CONTAINS 133 CHARACTERS                               00385201
 C22        BLOCK  CONTAINS  0 RECORDS                                   00385301
 C22        RECORDING  MODE IS F.                                        00385401
 C22    01  EMP-PRT-REC      PIC X(133).                                 00385501
 C21    FD  TRANS-FILE                                                   00386000
 C21        RECORD CONTAINS 80 CHARACTERS                                00387000
 C21        BLOCK  CONTAINS  0 RECORDS                                   00388000
 C21        RECORDING  MODE IS F.                                        00389000
 C21    01  TRANS-REC          PIC X(80).                                00389100
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
 C13    01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446000
 C13    01  WS-EMP-FILE-STATUS  PIC X(02).                               00447000
 C13    01  WS-EMP-REC.                                                  00448000
 C14      05  WS-EMP-REC-EMP-NUM         PIC X(6).                       00449000
 C14      05  WS-EMP-REC-LAST-NAME       PIC X(15).                      00449100
 C14      05  WS-EMP-REC-FIRST-NAME      PIC X(12).                      00449200
 C14      05  WS-EMP-REC-MID-IN          PIC X(1).                       00449300
 C14      05  WS-EMP-REC-DEPT-NUM        PIC X(3).                       00449400
 C14      05  WS-EMP-REC-JOB-TITLE       PIC X(11).                      00449500
 C14      05  WS-EMP-REC-EMP-SAL         PIC $$$$$.99.                   00449600
 C14      05  WS-EMP-REC-EMP-BONUS       PIC $$$$$.99.                   00449700
 C14      05  WS-EMP-REC-EMP-COMM        PIC $(5).99.                    00449800
 C21    01  WS-EMP-PRT-FILE-STATUS  PIC X(02).                           00450000
 C21    01  WS-EMP-PRT-REC.                                              00450200
 C21      05                             PIC X(05)     VALUE SPACES.     00450300
1                                                                                                              PAGE 0041
 MEMBER NAME  BACKUP21
 C21      05  WS-EMP-PRT-LNAM            PIC X(25).                      00450400
 C21      05                             PIC X(05)     VALUE SPACES.     00450500
 C21      05  WS-EMP-PRT-FNAM            PIC X(20).                      00450600
 C21      05                             PIC X(78)     VALUE SPACES.     00450700
 C13    01  WS-TRANS-EOF          PIC X(03)     VALUE SPACES.            00451200
 C13    01  WS-TRANS-FILE-STATUS  PIC X(02).                             00451300
 C13    01  WS-TRANS-REC.                                                00451400
 C14      05  WS-TRANS-REC-TRANS-ID           PIC X(2).                  00451500
 C14      05  WS-TRANS-REC-TRANS-NAME         PIC X(5).                  00451600
        LINKAGE SECTION.                                                 00452000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
            PERFORM 3000-PROCESS-TRANS-FILE                              00553000
                                                                         00554000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720100
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720200
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720400
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720500
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720600
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720700
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720800
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721300
 C9             END-EVALUATE                                             00721400
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721500
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
1                                                                                                              PAGE 0042
 MEMBER NAME  BACKUP21
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809100
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809200
 C9             END-EVALUATE                                             00809300
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
            END-READ                                                     00960000
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969100
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969200
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969400
 C9         END-EVALUATE                                                 00969500
            .                                                            00970000
        1110-PROCESS-DEPT-FIELDS.                                        00970100
       **********************************************************        00970200
       ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        00970300
       **********************************************************        00970400
            DISPLAY  '1110-PROCESS-DEPT-FIELDS'                          00970500
       **********************************************************        00970600
       ***= GOES AFTER NOT***************************************        00970700
       **********************************************************        00970800
       ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00970900
       **********************************************************        00971000
       ***END WITH "END-IF" STATEMENT****************************        00971100
       **********************************************************        00971200
 C17        IF WS-DEPT-REC-DEPT-NAME NOT = SPACE                         00971300
 C17            DISPLAY 'WS-DEPT-REC ='                                  00971400
1                                                                                                              PAGE 0043
 MEMBER NAME  BACKUP21
 C17                          WS-DEPT-REC                                00971500
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NAME='                         00971600
 C17                          WS-DEPT-REC-DEPT-NAME                      00971700
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NUM='                          00971800
 C17                          WS-DEPT-REC-DEPT-NUM                       00971900
 C17            DISPLAY 'WS-DEPT-REC-MANAGER-NUM='                       00972000
 C17                          WS-DEPT-REC-MANAGER-NUM                    00972100
 C17            DISPLAY 'WS-DEPT-REC-ADMIN-CODE='                        00972200
 C17                          WS-DEPT-REC-ADMIN-CODE                     00972300
            ELSE                                                         00972400
                DISPLAY 'BAD RECORD'                                     00972500
            END-IF                                                       00972600
            .                                                            00972700
 C15   **********************************************************        00972800
  V    *********************************************************         00972900
  |    **********************************************************        00973000
  |     2000-PROCESS-EMP-FILE.                                           00973100
  |    **********************************************************        00973200
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        00973300
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        00974000
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        00975000
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '2000-PROCESS-EMP-FILE'                              00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
  |         OPEN INPUT EMP-FILE                                          00979300
  |             EVALUATE WS-EMP-FILE-STATUS                              00979400
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00979500
  |               WHEN '10'          DISPLAY 'END OF FILE'               00979600
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00979700
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00979800
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00979900
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00980000
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00980100
  |             END-EVALUATE                                             00980200
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00980300
  |         DISPLAY ' '                                                  00980400
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00980500
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00980600
  |                                                                      00980700
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00980800
  |         PERFORM 2100-PROCESS-EMP-REC                                 00980900
  |                   UNTIL WS-EMP-EOF  = 'END'                          00981000
  |                                                                      00982000
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE EMP-FILE                                               00984000
  |             EVALUATE WS-EMP-FILE-STATUS                              00984100
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00984200
  |               WHEN '10'          DISPLAY 'END OF FILE'               00984300
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00984400
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00984500
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00984600
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00984700
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00984800
  |             END-EVALUATE                                             00984900
  |         DISPLAY ' '                                                  00985000
1                                                                                                              PAGE 0044
 MEMBER NAME  BACKUP21
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00986000
            .                                                            00986100
       ***********************************************************       00986200
       ***********************************************************       00986300
       ***********************************************************       00986400
 C21        OPEN OUTPUT EMP-PRT-FILE                                     00986500
  V             EVALUATE WS-EMP-PRT-FILE-STATUS                          00986600
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00986700
  |               WHEN '10'          DISPLAY 'END OF FILE'               00986800
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00986900
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00987000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00987100
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00987200
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00987300
  |             END-EVALUATE                                             00987400
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00987500
  |         DISPLAY ' '                                                  00987600
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00987700
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00987800
  |                                                                      00987900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00988000
  |         PERFORM 2100-WRITE-EMP-REC.                                  00988100
  |                                                                      00988200
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00988300
  |         CLOSE EMP-PRT-FILE                                           00988400
  |             EVALUATE WS-EMP-PRT-FILE-STATUS                          00988500
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00988700
  |               WHEN '10'          DISPLAY 'END OF FILE'               00988800
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00988900
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00989000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00989100
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00989200
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00989300
  |             END-EVALUATE                                             00989400
  |         DISPLAY ' '                                                  00989500
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00989600
  -         .                                                            00989700
  |                                                                      00989800
  |     2100-PROCESS-EMP-REC.                                            00989900
  |    **********************************************************        00990000
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00990100
  |    **********************************************************        00990200
  |    *    DISPLAY '2100-PROCESS-EMP-REC'                               00990300
  |                                                                      00990400
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00990500
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00990600
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00990700
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    00990800
  |         READ EMP-FILE INTO  WS-EMP-REC                               00990900
  |             AT END      MOVE 'END' TO WS-EMP-EOF                     00991000
  |             NOT AT END  PERFORM 2110-PROCESS-EMP-FIELDS              00992000
  |         END-READ                                                     00999800
  |             EVALUATE WS-EMP-FILE-STATUS                              00999900
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01000000
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01000100
  |               WHEN '10'          DISPLAY 'END OF FILE'               01000200
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01000300
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01000400
1                                                                                                              PAGE 0045
 MEMBER NAME  BACKUP21
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01000500
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01001000
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01002000
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01003000
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01004000
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01005000
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01006000
  |             END-EVALUATE                                             01007000
  -         .                                                            01008000
 C18    2110-PROCESS-EMP-FIELDS.                                         01008100
  V    **********************************************************        01008200
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01008300
  |    **********************************************************        01008400
  |         DISPLAY  '2110-PROCESS-EMP-FIELDS'                           01008500
  |    **********************************************************        01008600
  |    ***= GOES AFTER NOT***************************************        01008700
  |    **********************************************************        01008800
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01008900
  |    **********************************************************        01009000
  |    ***END WITH "END-IF" STATEMENT****************************        01009100
  |    **********************************************************        01009200
  |         IF WS-EMP-REC-LAST-NAME NOT = SPACE                          01009300
  |             DISPLAY 'WS-EMP-REC ='                                   01009400
  |                        WS-EMP-REC                                    01009500
  |             DISPLAY 'WS-EMP-REC-EMP-NUM='                            01009600
  |                        WS-EMP-REC-EMP-NUM                            01009700
  |             DISPLAY 'WS-EMP-REC-LAST-NAME='                          01009800
  |                        WS-EMP-REC-LAST-NAME                          01009900
  |             DISPLAY 'WS-EMP-REC-FIRST-NAME='                         01010000
  |                        WS-EMP-REC-FIRST-NAME                         01010100
  |             DISPLAY 'WS-EMP-REC-MID-IN='                             01010200
  |                        WS-EMP-REC-MID-IN                             01010300
  |             DISPLAY 'WS-EMP-REC-DEPT-NUM='                           01011000
  |                        WS-EMP-REC-DEPT-NUM                           01012000
  |             DISPLAY 'WS-EMP-REC-JOB-TITLE='                          01013000
  |                        WS-EMP-REC-JOB-TITLE                          01014000
  |             DISPLAY 'WS-EMP-REC-EMP-SAL='                            01015000
  |                        WS-EMP-REC-EMP-SAL                            01016000
  |             DISPLAY 'WS-EMP-REC-EMP-BONUS='                          01017000
  |                        WS-EMP-REC-EMP-BONUS                          01018000
  |             DISPLAY 'WS-EMP-REC-EMP-COMM='                           01019000
  |                        WS-EMP-REC-EMP-COMM                           01019100
                PERFORM 2111-MOVE-WRITE-EMP-REC                          01019200
  |         ELSE                                                         01019300
  |             DISPLAY 'BAD RECORD'                                     01019400
  |         END-IF                                                       01019500
  _         .                                                            01019600
        2111-MOVE-WRITE-EMP-REC.                                         01019700
 C19   **********************************************************        01019800
  V    *************TRANS FILLE*********************************         01019900
  |    **********************************************************        01020000
  |     3000-PROCESS-TRANS-FILE.                                         01020100
  |    **********************************************************        01020200
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        01021000
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        01022000
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        01023000
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        01024000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        01025000
1                                                                                                              PAGE 0046
 MEMBER NAME  BACKUP21
  |    **********************************************************        01026000
  |         DISPLAY '3000-PROCESS-TRANS-FILE'                            01027000
  |                                                                      01028000
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 01029000
  |         OPEN INPUT TRANS-FILE                                        01029100
  |             EVALUATE WS-TRANS-FILE-STATUS                            01029200
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01029300
  |               WHEN '10'          DISPLAY 'END OF FILE'               01029400
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01029500
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01029600
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01029700
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01029800
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01029900
  |             END-EVALUATE                                             01030000
  |         DISPLAY '**** S-T-A-R-T OF TRANS FILE****'                   01031000
  |         DISPLAY ' '                                                  01032000
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 01033000
  |         MOVE SPACES  TO  WS-TRANS-EOF                                01034000
  |                                                                      01035000
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 01036000
  |         PERFORM 3100-PROCESS-TRANS-REC                               01037000
  |                   UNTIL WS-TRANS-EOF  = 'END'                        01038000
  |                                                                      01039000
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  01039100
  |         CLOSE TRANS-FILE                                             01039200
  |             EVALUATE WS-TRANS-FILE-STATUS                            01039300
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01039400
  |               WHEN '10'          DISPLAY 'END OF FILE'               01039500
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01039600
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01039700
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01039800
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01039900
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01040000
  |             END-EVALUATE                                             01041000
  |         DISPLAY ' '                                                  01042000
  |         DISPLAY '****  E-N-D OF TRANS FILE ****'                     01043000
  |         .                                                            01044000
  |                                                                      01045000
  |     3100-PROCESS-TRANS-REC.                                          01046000
  |    **********************************************************        01047000
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           01048000
  |    **********************************************************        01049000
  |    *    DISPLAY '3100-PROCESS-TRANS-REC'                             01049100
  |                                                                      01049200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    01049300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 01049400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 01049500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    01049600
  |         READ TRANS-FILE INTO  WS-TRANS-REC                           01049700
  |             AT END      MOVE 'END' TO WS-TRANS-EOF                   01049800
  |             NOT AT END  PERFORM 3110-PROCESS-TRANS-FIELDS            01049900
  |         END-READ                                                     01050000
  |             EVALUATE WS-TRANS-FILE-STATUS                            01051000
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01052000
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01053000
  |               WHEN '10'          DISPLAY 'END OF FILE'               01054000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01055000
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01056000
1                                                                                                              PAGE 0047
 MEMBER NAME  BACKUP21
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01057000
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01058000
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01059000
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01059100
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01059200
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01059300
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01059400
  |             END-EVALUATE                                             01059500
  -         .                                                            01059600
 C19    3110-PROCESS-TRANS-FIELDS.                                       01059700
  V    **********************************************************        01059800
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01059900
  |    **********************************************************        01060000
  |    *    DISPLAY  '3110-PROCESS-TRANS-FIELDS'                         01061000
  |    **********************************************************        01062000
  |    ***= GOES AFTER NOT***************************************        01063000
  |    **********************************************************        01064000
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01065000
  |    **********************************************************        01066000
  |    ***END WITH "END-IF" STATEMENT****************************        01067000
  |    **********************************************************        01068000
  |    *    IF WS-TRANS-REC-TRANS-ID NOT = SPACE                         01069000
  |    *        DISPLAY 'WS-TRAS-REC ='                                  01069100
  |    *                   WS-TRANS-REC                                  01069200
  |    *        DISPLAY 'WS-TRANS-REC-TRANS-ID='                         01069300
  |    *                   WS-TRANS-REC-TRANS-ID                         01069400
  |    *        DISPLAY 'WS-EMP-REC-TRANS-NAME='                         01069500
  |    *                   WS-TRANS-REC-TRANS-NAME                       01069600
  |    **   ELSE                                                         01079200
  |    *        DISPLAY 'INVALAD RECORD'                                 01079300
  |    *    END-IF                                                       01079400
 C20        EVALUATE WS-TRANS-REC-TRANS-ID                               01079500
  |           WHEN SPACE          DISPLAY  'INVALAD TRANS'               01079600
  |           WHEN OTHER          DISPLAY 'WS-TRAS-REC ='                01079700
  |                                          WS-TRANS-REC                01079800
  |                               DISPLAY 'WS-TRANS-REC-TRANS-ID='       01079900
  |                                          WS-TRANS-REC-TRANS-ID       01080000
  |                               DISPLAY 'WS-EMP-REC-TRANS-NAME='       01080100
  |                                          WS-TRANS-REC-TRANS-NAME     01080200
  _         .                                                            01081000
       ********  END OF PROGRAM    COBSHEL ***********************       01090000
1                                                                                                              PAGE 0048
 MEMBER NAME  BACKUP22
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106000
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107000
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108000
 C12   *    C12           10-27      DEFINE EMP FILE                     00109000
 C13   *    C13           10-27      DEFINE EMP FILE STATUS CHAR LENGHT  00109100
 C14   *    C14           10-27      ADD EMP INDIVIDUAL FIELDS           00109200
 C15   *    C15           10-27      REPEAT DEPTFILE AS EMP FILE PROCESS 00109300
 C16   *    C16           10-27      MOVE END READ DISPLAY TO 1110       00109400
 C17   *    C17           10-30      DEPTFILE EDIT BLANKS                00109500
 C18   *    C18           10-31      EMPFILE EDIT BLANKS                 00109600
 C19   *    C19           11-01      PROCESS TRANS-FILE IF STATEMENT     00109700
 C20   *    C20           11-01      PROCESS TRANS-FILE EVALUATE         00109800
 C21   *    C21           11-01      EMP FILE NUMERICS                   00109900
 C22   *    C22           11-08      EMP PRINT FILE                      00110000
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       *** 2000-PROCESS-EMP-FILE                                         00191000
       ***     OPEN EMP-FILE                                             00192000
       ***         2100-PROCESS-EMP-REC                                  00193000
       ***     CLOSE EMP-FILE                                            00194000
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195000
       *** 3000-PROCESS-TRANS-FILE                                       00196000
       ***     OPEN TRANS-FILE                                           00197000
       ***         3100-PROCESS-TRANS-REC                                00198000
       ***     CLOSE TRANS-FILE                                          00199000
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199100
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280000
1                                                                                                              PAGE 0049
 MEMBER NAME  BACKUP22
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282000
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283000
 C22        SELECT EMP-PRT-FILE ASSIGN TO PRINTEMP.                      00284000
 C19        SELECT TRANS-FILE   ASSIGN TO TRANS                          00286000
 C19              FILE STATUS IS WS-TRANS-FILE-STATUS.                   00287000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC         PIC X(80).                                  00380000
       * EMP-FILE DEFINITION                                             00380100
 C12    FD  EMP-FILE                                                     00381000
 C12        RECORD CONTAINS 80 CHARACTERS                                00382000
 C12        BLOCK  CONTAINS  0 RECORDS                                   00383000
 C12        RECORDING  MODE IS F.                                        00384000
 C12    01  EMP-REC          PIC X(80).                                  00385000
       * EMP-PRT-FILE DEFINITION                                         00385100
 C22    FD  EMP-PRT-FILE                                                 00385200
 C22        RECORD CONTAINS 133 CHARACTERS                               00385300
 C22        BLOCK  CONTAINS  0 RECORDS                                   00385400
 C22        RECORDING  MODE IS F.                                        00385500
 C22    01  EMP-PRT-REC      PIC X(133).                                 00385600
       * TRANS-FILE DEFINITION                                           00386200
 C19    FD  TRANS-FILE                                                   00386300
 C19        RECORD CONTAINS 80 CHARACTERS                                00387000
 C19        BLOCK  CONTAINS  0 RECORDS                                   00388000
 C19        RECORDING  MODE IS F.                                        00389000
 C19    01  TRANS-REC          PIC X(80).                                00389100
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
 C13    01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446000
 C13    01  WS-EMP-FILE-STATUS  PIC X(02).                               00447000
 C13    01  WS-EMP-REC.                                                  00448000
 C14      05  WS-EMP-REC-EMP-NUM         PIC X(6).                       00449000
 C14      05  WS-EMP-REC-LAST-NAME       PIC X(15).                      00449100
 C14      05  WS-EMP-REC-FIRST-NAME      PIC X(12).                      00449200
 C14      05  WS-EMP-REC-MID-IN          PIC X(1).                       00449300
 C14      05  WS-EMP-REC-DEPT-NUM        PIC X(3).                       00449400
 C14      05  WS-EMP-REC-JOB-TITLE       PIC X(11).                      00449500
 C14      05  WS-EMP-REC-EMP-SAL         PIC 9(5)V99.                    00449600
 C14      05  WS-EMP-REC-EMP-BONUS       PIC 9(5)V99.                    00449700
 C14      05  WS-EMP-REC-EMP-COMM        PIC 9(5)V99.                    00449800
1                                                                                                              PAGE 0050
 MEMBER NAME  BACKUP22
 C21    01  WS-EMP-SAL              PIC $9(5).99.                        00449900
 C21    01  WS-EMP-BONUS            PIC $9(5).99.                        00450000
 C21    01  WS-EMP-COMM             PIC $9(5).99.                        00451000
 C21    01  WS-EMP-LAST-NAME        PIC X(25).                           00451100
 C21    01  WS-EMP-FIRST-NAME       PIC X(20).                           00451200
 C22    01  WS-EMP-TOTAL-SALARY     PIC 9(7)V9(2).                       00451300
 C22    01  WS-EMP-PRT-LINE-COUNT    PIC 9(2)     VALUE 0.               00451400
 C22    01  WS-EMP-PRT-PAGE-COUNT    PIC 9(5)     VALUE 0.               00451500
 C22    01  WS-EMP-PRT-HDR1.                                             00451900
 C22      05  FILLER                PIC X(20)     VALUE SPACES.          00452000
 C22      05                        PIC X(22) VALUE '-ABC CONSULTING-'.  00452100
 C22      05                        PIC X(20)     VALUE SPACES.          00452200
 C22      05                        PIC X(10)     VALUE 'PAGE NO:'.      00452300
 C22      05  WS-EMP-PRT-HDR1-PAGE-COUNT  PIC ZZZZ9.                     00452400
 C22      05                        PIC X(21)     VALUE SPACES.          00452500
 C22    01  WS-EMP-PRT-HDR2.                                             00452800
 C22      05                         PIC X(05)     VALUE SPACES.         00452900
 C22      05                         PIC X(25) VALUE 'L A S T N A M E'.  00453000
 C22      05                         PIC X(05)     VALUE SPACES.         00453100
 C22      05                         PIC X(20)                           00453200
 C22                                         VALUE 'F I R S T N A M E'.  00453300
 C22      05                         PIC X(78)     VALUE SPACES.         00453400
 C21    01  WS-EMP-PRT-REC.                                              00454200
 C21      05                             PIC X(05)     VALUE SPACES.     00454300
 C21      05  WS-EMP-PRT-LNAM            PIC X(25).                      00454400
 C21      05                             PIC X(05)     VALUE SPACES.     00454500
 C21      05  WS-EMP-PRT-FNAM            PIC X(20).                      00454600
 C21      05                             PIC X(78)     VALUE SPACES.     00454700
 C22    01  WS-EMP-PRT-TOTAL-SALARY.                                     00454800
 C22      05                         PIC X(10)  VALUE SPACES.            00454900
 C22      05                         PIC X(20)  VALUE 'TOTAL SALARY='.   00455000
 C22      05                         PIC X(02)  VALUE SPACES.            00455100
       * CHANGE TO $$$$,$$$.99 IF NOT WORKING******************          00455200
 C22      05  WS-EMP-PRT-TOT-SALARY  PIC $$,$$$,$$$.99.                  00455300
 C22      05                         PIC X(90)  VALUE SPACES.            00455400
 C13    01  WS-TRANS-EOF             PIC X(03).                          00455500
 C13    01  WS-TRANS-FILE-STATUS     PIC X(02).                          00455600
 C13    01  WS-TRANS-REC.                                                00455700
 C14      05  WS-TRANS-REC-TRANS-ID           PIC X(2).                  00455800
 C14      05  WS-TRANS-REC-TRANS-NAME         PIC X(5).                  00455900
        LINKAGE SECTION.                                                 00456000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
            PERFORM 3000-PROCESS-TRANS-FILE                              00553000
                                                                         00554000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
1                                                                                                              PAGE 0051
 MEMBER NAME  BACKUP22
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720100
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720200
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720400
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720500
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720600
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720700
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720800
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721300
 C9             END-EVALUATE                                             00721400
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721500
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809100
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809200
 C9             END-EVALUATE                                             00809300
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
1                                                                                                              PAGE 0052
 MEMBER NAME  BACKUP22
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
            END-READ                                                     00960000
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969100
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969200
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969400
 C9         END-EVALUATE                                                 00969500
            .                                                            00970000
        1110-PROCESS-DEPT-FIELDS.                                        00970100
       **********************************************************        00970200
       ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        00970300
       **********************************************************        00970400
            DISPLAY  '1110-PROCESS-DEPT-FIELDS'                          00970500
       **********************************************************        00970600
       ***= GOES AFTER NOT***************************************        00970700
       **********************************************************        00970800
       ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00970900
       **********************************************************        00971000
       ***END WITH "END-IF" STATEMENT****************************        00971100
       **********************************************************        00971200
 C17        IF WS-DEPT-REC-DEPT-NAME NOT = SPACE                         00971300
 C17            DISPLAY 'WS-DEPT-REC ='                                  00971400
 C17                          WS-DEPT-REC                                00971500
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NAME='                         00971600
 C17                          WS-DEPT-REC-DEPT-NAME                      00971700
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NUM='                          00971800
 C17                          WS-DEPT-REC-DEPT-NUM                       00971900
 C17            DISPLAY 'WS-DEPT-REC-MANAGER-NUM='                       00972000
 C17                          WS-DEPT-REC-MANAGER-NUM                    00972100
 C17            DISPLAY 'WS-DEPT-REC-ADMIN-CODE='                        00972200
 C17                          WS-DEPT-REC-ADMIN-CODE                     00972300
            ELSE                                                         00972400
                DISPLAY 'BAD RECORD'                                     00972500
            END-IF                                                       00972600
            .                                                            00972700
 C15   **********************************************************        00972800
  V    *********************************************************         00972900
  |    **********************************************************        00973000
  |     2000-PROCESS-EMP-FILE.                                           00973100
  |    **********************************************************        00973200
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        00973300
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        00974000
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        00975000
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '2000-PROCESS-EMP-FILE'                              00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
1                                                                                                              PAGE 0053
 MEMBER NAME  BACKUP22
            MOVE 0 TO WS-EMP-PRT-PAGE-COUNT                              00979300
            MOVE 50 TO WS-EMP-PRT-LINE-COUNT                             00979400
  |         OPEN INPUT EMP-FILE                                          00979500
  |             EVALUATE WS-EMP-FILE-STATUS                              00979600
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00979700
  |               WHEN '10'          DISPLAY 'END OF FILE'               00979800
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00979900
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00980000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00980100
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00980200
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00980300
  |             END-EVALUATE                                             00980400
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00980500
  |         DISPLAY ' '                                                  00980600
 C22        OPEN OUTPUT EMP-PRT-FILE                                     00980700
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 2100-PROCESS-EMP-REC                                 00982100
  |                   UNTIL WS-EMP-EOF  = 'END'                          00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE EMP-FILE                                               00984000
  |             EVALUATE WS-EMP-FILE-STATUS                              00984100
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00984200
  |               WHEN '10'          DISPLAY 'END OF FILE'               00984300
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00984400
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00984500
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00984600
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00984700
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00984800
  |             END-EVALUATE                                             00984900
  |         DISPLAY ' '                                                  00985000
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00986000
 C22        WRITE EMP-PRT-REC FROM WS-EMP-PRT-TOTAL-SALARY AFTER 2 LINES 00986100
 C22        CLOSE EMP-PRT-FILE                                           00986200
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
  |                                                                      00991600
  |     2100-PROCESS-EMP-REC.                                            00991700
  |    **********************************************************        00991800
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00991900
  |    **********************************************************        00992000
  |    *    DISPLAY '2100-PROCESS-EMP-REC'                               00992100
  |                                                                      00992200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00992400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00992500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    00992600
  |         READ EMP-FILE INTO  WS-EMP-REC                               00992700
  |             AT END      MOVE 'END' TO WS-EMP-EOF                     00992800
 C23            NOT AT END  DISPLAY 'WS-EMP-REC ='                       00993000
  V                                    WS-EMP-REC                        00993100
  |    **********************************************************        00993200
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993300
1                                                                                                              PAGE 0054
 MEMBER NAME  BACKUP22
  |    **********************************************************        00993400
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993500
  |    **********************************************************        00993600
  |    ***END WITH "END-IF" STATEMENT****************************        00993700
  |    **********************************************************        00993800
  |         IF WS-EMP-REC-LAST-NAME NOT = SPACE                          00994000
  |             DISPLAY 'WS-EMP-REC ='                                   00995000
  |                        WS-EMP-REC                                    00996000
  |             DISPLAY 'WS-EMP-REC-EMP-NUM='                            00997000
  |                        WS-EMP-REC-EMP-NUM                            00998000
  |             DISPLAY 'WS-EMP-REC-LAST-NAME='                          00999000
  |                        WS-EMP-REC-LAST-NAME                          00999100
  |             DISPLAY 'WS-EMP-REC-FIRST-NAME='                         00999200
  |                        WS-EMP-REC-FIRST-NAME                         00999300
  |             DISPLAY 'WS-EMP-REC-MID-IN='                             00999400
  |                        WS-EMP-REC-MID-IN                             00999500
  |             DISPLAY 'WS-EMP-REC-DEPT-NUM='                           00999600
  |                        WS-EMP-REC-DEPT-NUM                           00999700
  |             DISPLAY 'WS-EMP-REC-JOB-TITLE='                          00999800
  |                        WS-EMP-REC-JOB-TITLE                          00999900
  C21           MOVE    WS-EMP-REC-EMP-SAL TO WS-EMP-SAL                 01000600
  C21           DISPLAY WS-EMP-SAL                                       01000700
  C21           MOVE    WS-EMP-REC-EMP-BONUS TO WS-EMP-BONUS             01000800
  C21           DISPLAY WS-EMP-BONUS                                     01000900
  C21           MOVE    WS-EMP-REC-EMP-COMM TO WS-EMP-COMM               01001000
  C21           DISPLAY WS-EMP-COMM                                      01001100
  |         ELSE                                                         01001300
  |             DISPLAY 'BAD RECORD'                                     01001400
  >         END-IF                                                       01001500
  |         END-READ                                                     01001600
  |             EVALUATE WS-EMP-FILE-STATUS                              01001700
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01001800
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01001900
  |               WHEN '10'          DISPLAY 'END OF FILE'               01002000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01002100
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01002200
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01002300
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01002400
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01002500
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01003000
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01004000
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01005000
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01006000
  |             END-EVALUATE                                             01007000
  |         PERFORM 2110-MOVE-WRITE-EMP-REC                              01007100
  -         .                                                            01008000
 C22    2110-MOVE-WRITE-EMP-REC.                                         01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '2110-MOVE-WRITE-EMP-REC'                           01008500
  |         DISPLAY  WS-EMP-REC                                          01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
            IF   WS-EMP-PRT-LINE-COUNT > 11                              01009000
            THEN     PERFORM 2112-WRITE-PRT-EMP-HDRS                     01010000
                     PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020000
1                                                                                                              PAGE 0055
 MEMBER NAME  BACKUP22
            ELSE                                                         01020100
                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                   01020200
            END-IF                                                       01020300
  _         .                                                            01020400
       ****************************************************************  01020500
       ****************************************************************  01020700
       ****************************************************************  01020800
        2111-MOVE-FLDS-WRITE-EMP-DTL.                                    01020900
            DISPLAY '2111-MOVE-FLDS-WRITE-EMP-DTL'                       01021000
            MOVE  WS-EMP-REC-LAST-NAME  TO WS-EMP-PRT-LNAM               01021100
            MOVE  WS-EMP-REC-FIRST-NAME TO WS-EMP-PRT-FNAM               01021200
            ADD   WS-EMP-REC-EMP-SAL    TO WS-EMP-TOTAL-SALARY           01021300
            ADD      1                  TO WS-EMP-PRT-LINE-COUNT         01021500
            MOVE  WS-EMP-TOTAL-SALARY   TO WS-EMP-PRT-TOT-SALARY         01021600
            WRITE EMP-PRT-REC         FROM WS-EMP-PRT-REC AFTER 1 LINE   01021700
            .                                                            01022000
        2112-WRITE-PRT-EMP-HDRS.                                         01022100
            DISPLAY '2112-WRITE-PRT-EMP-HDRS'                            01022200
            ADD          1       TO WS-EMP-PRT-PAGE-COUNT                01022300
            MOVE   WS-EMP-PRT-PAGE-COUNT TO WS-EMP-PRT-HDR1-PAGE-COUNT   01022400
            MOVE         0       TO WS-EMP-PRT-LINE-COUNT                01022500
            WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR1 AFTER PAGE         01022600
            WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR2 AFTER 2 LINES      01022700
            .                                                            01022900
 C19   **********************************************************        01023000
  V    *************TRANS FILLE*********************************         01023100
  |    **********************************************************        01023200
  |     3000-PROCESS-TRANS-FILE.                                         01023300
  |    **********************************************************        01023400
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        01023500
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        01023600
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        01023700
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        01024000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        01025000
  |    **********************************************************        01026000
  |         DISPLAY '3000-PROCESS-TRANS-FILE'                            01027000
  |                                                                      01028000
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 01029000
  |         OPEN INPUT TRANS-FILE                                        01029100
  |             EVALUATE WS-TRANS-FILE-STATUS                            01029200
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01029300
  |               WHEN '10'          DISPLAY 'END OF FILE'               01029400
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01029500
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01029600
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01029700
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01029800
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01029900
  |             END-EVALUATE                                             01030000
  |         DISPLAY '**** S-T-A-R-T OF TRANS FILE****'                   01031000
  |         DISPLAY ' '                                                  01032000
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 01033000
  |         MOVE SPACES  TO  WS-TRANS-EOF                                01034000
  |                                                                      01035000
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 01036000
  |         PERFORM 3100-PROCESS-TRANS-REC                               01037000
  |                   UNTIL WS-TRANS-EOF  = 'END'                        01038000
  |                                                                      01039000
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  01039100
1                                                                                                              PAGE 0056
 MEMBER NAME  BACKUP22
  |         CLOSE TRANS-FILE                                             01039200
  |             EVALUATE WS-TRANS-FILE-STATUS                            01039300
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01039400
  |               WHEN '10'          DISPLAY 'END OF FILE'               01039500
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01039600
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01039700
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01039800
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01039900
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01040000
  |             END-EVALUATE                                             01041000
  |         DISPLAY ' '                                                  01042000
  |         DISPLAY '****  E-N-D OF TRANS FILE ****'                     01043000
  |         .                                                            01044000
  |                                                                      01045000
  |     3100-PROCESS-TRANS-REC.                                          01046000
  |    **********************************************************        01047000
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           01048000
  |    **********************************************************        01049000
  |    *    DISPLAY '3100-PROCESS-TRANS-REC'                             01049100
  |                                                                      01049200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    01049300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 01049400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 01049500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    01049600
  |         READ TRANS-FILE INTO  WS-TRANS-REC                           01049700
  |             AT END      MOVE 'END' TO WS-TRANS-EOF                   01049800
  |             NOT AT END  PERFORM 3110-PROCESS-TRANS-FIELDS            01049900
  |         END-READ                                                     01050000
  |             EVALUATE WS-TRANS-FILE-STATUS                            01051000
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01052000
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01053000
  |               WHEN '10'          DISPLAY 'END OF FILE'               01054000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01055000
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01056000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01057000
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01058000
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01059000
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01059100
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01059200
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01059300
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01059400
  |             END-EVALUATE                                             01059500
  -         .                                                            01059600
 C19    3110-PROCESS-TRANS-FIELDS.                                       01059700
  V    **********************************************************        01059800
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01059900
  |    **********************************************************        01060000
  |    *    DISPLAY  '3110-PROCESS-TRANS-FIELDS'                         01061000
  |    **********************************************************        01062000
  |    ***= GOES AFTER NOT***************************************        01063000
  |    **********************************************************        01064000
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01065000
  |    **********************************************************        01066000
  |    ***END WITH "END-IF" STATEMENT****************************        01067000
  |    **********************************************************        01068000
  |    *    IF WS-TRANS-REC-TRANS-ID NOT = SPACE                         01069000
  |    *        DISPLAY 'WS-TRAS-REC ='                                  01069100
  |    *                   WS-TRANS-REC                                  01069200
1                                                                                                              PAGE 0057
 MEMBER NAME  BACKUP22
  |    *        DISPLAY 'WS-TRANS-REC-TRANS-ID='                         01069300
  |    *                   WS-TRANS-REC-TRANS-ID                         01069400
  |    *        DISPLAY 'WS-EMP-REC-TRANS-NAME='                         01069500
  |    *                   WS-TRANS-REC-TRANS-NAME                       01069600
  |    **   ELSE                                                         01079200
  |    *        DISPLAY 'INVALAD RECORD'                                 01079300
  |    *    END-IF                                                       01079400
 C20        EVALUATE WS-TRANS-REC-TRANS-ID                               01079500
  |           WHEN SPACE          DISPLAY  'INVALAD TRANS'               01079600
  |           WHEN OTHER          DISPLAY 'WS-TRAS-REC ='                01079700
  |                                          WS-TRANS-REC                01079800
  |                               DISPLAY 'WS-TRANS-REC-TRANS-ID='       01079900
  |                                          WS-TRANS-REC-TRANS-ID       01080000
  |                               DISPLAY 'WS-EMP-REC-TRANS-NAME='       01080100
  |                                          WS-TRANS-REC-TRANS-NAME     01080200
  _         .                                                            01081000
       ********  END OF PROGRAM    COBSHEL ***********************       01090000
1                                                                                                              PAGE 0058
 MEMBER NAME  COMPILE6
 //TRAIN006 JOB ,,CLASS=A,NOTIFY=&SYSUID                            <CHG 00010000
 //   JCLLIB ORDER=(TRAIN00.CLASS.COBOL)                                 00020000
 //STEP1        EXEC IGYWCLG,LIBPRFX=CEE,PARM.COBOL='LIST,MAP'           00030000
 //**************************************************************        00040000
 //**************************************************************        00050000
 //****  CHANGE TRAIN00 TO YOUR TSOID   FOR THE NEXT 3 DSNS              00060000
 //****    AND CHANGE THE JOBNAME  AND THE TRANFILE DSN  ********        00070000
 //**************************************************************        00080000
 //**************************************************************        00090000
 //COBOL.SYSIN   DD  DSN=TRAIN00.CLASS.COBOL(S0C7ABND),DISP=SHR     <CHG 00100000
 //LKED.SYSLMOD  DD  DSNAME=TRAIN00.CLASS.LOADLIB(COBSHEL),DISP=SHR <CHG 00110000
 //GO.STEPLIB    DD  DSNAME=TRAIN00.CLASS.LOADLIB,DISP=SHR          <CHG 00120000
 //**************************************************************        00130000
 //**************************************************************        00140000
 //GO.SYSOUT     DD  SYSOUT=*,OUTLIM=1000                                00150000
 //DEPTFILE  DD DSN=TRAIN00.CLASS.DEPTFILE,DISP=SHR                      00160000
 //EMPFILE   DD DSN=TRAIN00.CLASS.EMPFILE,DISP=SHR                       00170000
 //TRANFILE  DD DSN=TRAIN00.CLASS.TRANS,DISP=SHR                    <CHG 00180000
 //PRTDEPT   DD SYSOUT=*,OUTLIM=1000                                     00190000
 //PRTEMP    DD SYSOUT=*,OUTLIM=1000                                     00200000
1                                                                                                              PAGE 0059
 MEMBER NAME  S0C7ABND
        IDENTIFICATION DIVISION.
        PROGRAM-ID. ABEND0C7.
        DATA DIVISION.
        WORKING-STORAGE SECTION.
        01  WS-COUNTER           VALUE 0              PIC 999  COMP-3.
        01  WS-COUNTER-REDEF REDEFINES WS-COUNTER   PIC XXX.
        PROCEDURE DIVISION.

            MOVE 'XXX'  TO WS-COUNTER-REDEF
            DISPLAY ' B4 IF NUMERIC TEST 2 -------------------------'
            IF WS-COUNTER IS NUMERIC
                 COMPUTE WS-COUNTER = WS-COUNTER + 1
                 DISPLAY 'WS-COUNTER=' WS-COUNTER
            ELSE DISPLAY 'FIELD WS-COUNTER IS NOT NUMERIC'
            END-IF

            DISPLAY ' START --- ABEND0C7 --------------------------'
            DISPLAY ' B4 MOVE OF XXX   '
            MOVE 'XXX'  TO WS-COUNTER-REDEF
            DISPLAY ' B4 COMPUTE   --------------------------------'
            COMPUTE WS-COUNTER = WS-COUNTER + 1
            DISPLAY ' B4 ADD 1   ----------------------------------'
            ADD 1     TO         WS-COUNTER
            GOBACK.
1                                                                                                              PAGE 0060
 MEMBER NAME  HEX
 1234567890 ABCDEFGHIJKLMNOPQRSTUVWXYZ                                   00010000
 +=                                                                      00020000
                                                                         00030000
1                                                                                                              PAGE 0061
 MEMBER NAME  BACKUP23
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106000
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107000
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108000
 C12   *    C12           10-27      DEFINE EMP FILE                     00109000
 C13   *    C13           10-27      DEFINE EMP FILE STATUS CHAR LENGHT  00109100
 C14   *    C14           10-27      ADD EMP INDIVIDUAL FIELDS           00109200
 C15   *    C15           10-27      REPEAT DEPTFILE AS EMP FILE PROCESS 00109300
 C16   *    C16           10-27      MOVE END READ DISPLAY TO 1110       00109400
 C17   *    C17           10-30      DEPTFILE EDIT BLANKS                00109500
 C18   *    C18           10-31      EMPFILE EDIT BLANKS                 00109600
 C19   *    C19           11-01      PROCESS TRANS-FILE IF STATEMENT     00109700
 C20   *    C20           11-01      PROCESS TRANS-FILE EVALUATE         00109800
 C21   *    C21           11-01      EMP FILE NUMERICS                   00109900
 C22   *    C22           11-08      EMP PRINT FILE                      00110000
 C23   *    C23           11-10      EMP PRINT FILE MI                   00110100
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       *** 2000-PROCESS-EMP-FILE                                         00191000
       ***     OPEN EMP-FILE                                             00192000
       ***         2100-PROCESS-EMP-REC                                  00193000
       ***     CLOSE EMP-FILE                                            00194000
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195000
       *** 3000-PROCESS-TRANS-FILE                                       00196000
       ***     OPEN TRANS-FILE                                           00197000
       ***         3100-PROCESS-TRANS-REC                                00198000
       ***     CLOSE TRANS-FILE                                          00199000
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199100
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
1                                                                                                              PAGE 0062
 MEMBER NAME  BACKUP23
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282000
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283000
 C22        SELECT EMP-PRT-FILE ASSIGN TO PRINTEMP.                      00284000
 C19        SELECT TRANS-FILE   ASSIGN TO TRANS                          00286000
 C19              FILE STATUS IS WS-TRANS-FILE-STATUS.                   00287000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC         PIC X(80).                                  00380000
       * EMP-FILE DEFINITION                                             00380100
 C12    FD  EMP-FILE                                                     00381000
 C12        RECORD CONTAINS 80 CHARACTERS                                00382000
 C12        BLOCK  CONTAINS  0 RECORDS                                   00383000
 C12        RECORDING  MODE IS F.                                        00384000
 C12    01  EMP-REC          PIC X(80).                                  00385000
       * EMP-PRT-FILE DEFINITION                                         00385100
 C22    FD  EMP-PRT-FILE                                                 00385200
 C22        RECORD CONTAINS 133 CHARACTERS                               00385300
 C22        BLOCK  CONTAINS  0 RECORDS                                   00385400
 C22        RECORDING  MODE IS F.                                        00385500
 C22    01  EMP-PRT-REC      PIC X(133).                                 00385600
       * TRANS-FILE DEFINITION                                           00386200
 C19    FD  TRANS-FILE                                                   00386300
 C19        RECORD CONTAINS 80 CHARACTERS                                00387000
 C19        BLOCK  CONTAINS  0 RECORDS                                   00388000
 C19        RECORDING  MODE IS F.                                        00389000
 C19    01  TRANS-REC          PIC X(80).                                00389100
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
 C13    01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446000
 C13    01  WS-EMP-FILE-STATUS  PIC X(02).                               00447000
 C13    01  WS-EMP-REC.                                                  00448000
 C14      05  WS-EMP-REC-EMP-NUM         PIC X(6).                       00449000
 C14      05  WS-EMP-REC-LAST-NAME       PIC X(15).                      00449100
 C14      05  WS-EMP-REC-FIRST-NAME      PIC X(12).                      00449200
 C14      05  WS-EMP-REC-MID-IN          PIC X(1).                       00449300
 C14      05  WS-EMP-REC-DEPT-NUM        PIC X(3).                       00449400
 C14      05  WS-EMP-REC-JOB-TITLE       PIC X(11).                      00449500
 C14      05  WS-EMP-REC-EMP-SAL         PIC 9(5)V99.                    00449600
 C14      05  WS-EMP-REC-EMP-BONUS       PIC 9(5)V99.                    00449700
1                                                                                                              PAGE 0063
 MEMBER NAME  BACKUP23
 C14      05  WS-EMP-REC-EMP-COMM        PIC 9(5)V99.                    00449800
 C21    01  WS-EMP-SAL              PIC $9(5).99.                        00449900
 C21    01  WS-EMP-BONUS            PIC $9(5).99.                        00450000
 C21    01  WS-EMP-COMM             PIC $9(5).99.                        00451000
 C22    01  WS-EMP-TOTAL-SALARY     PIC 9(7)V9(2).                       00451400
 C22    01  WS-EMP-PRT-LINE-COUNT    PIC 9(2)     VALUE 0.               00451500
 C22    01  WS-EMP-PRT-PAGE-COUNT    PIC 9(5)     VALUE 0.               00451600
 C22    01  WS-EMP-PRT-HDR1.                                             00451900
 C22      05  FILLER                PIC X(20)     VALUE SPACES.          00452000
 C22      05                        PIC X(22) VALUE '-ABC CONSULTING-'.  00452100
 C22      05                        PIC X(20)     VALUE SPACES.          00452200
 C22      05                        PIC X(10)     VALUE 'PAGE NO:'.      00452300
 C22      05  WS-EMP-PRT-HDR1-PAGE-COUNT  PIC ZZZZ9.                     00452400
 C22      05                        PIC X(21)     VALUE SPACES.          00452500
 C22    01  WS-EMP-PRT-HDR2.                                             00452800
 C23      05                         PIC X(05)      VALUE SPACES.        00453100
 C23      05                         PIC X(15) VALUE 'D E P T N U M .'.  00453200
 C22      05                         PIC X(05)      VALUE SPACES.        00453300
 C22      05                         PIC X(15) VALUE 'L A S T N A M E'.  00453400
 C22      05                         PIC X(05)      VALUE SPACES.        00453500
 C22      05                         PIC X(17)                           00453600
 C22                                         VALUE 'F I R S T N A M E'.  00453700
 C22      05                         PIC X(05)      VALUE SPACES.        00453800
 C22      05                         PIC X(05)                           00453900
 C22                                         VALUE 'M . I'.              00454000
 C22      05                         PIC X(61)     VALUE SPACES.         00454100
 C21    01  WS-EMP-PRT-REC.                                              00454200
 C21      05                             PIC X(05)     VALUE SPACES.     00454300
 C21      05  WS-EMP-PRT-DEPT-NUM        PIC X(15).                      00454400
 C21      05                             PIC X(05)     VALUE SPACES.     00454500
 C21      05  WS-EMP-PRT-LNAM            PIC X(15).                      00454600
 C21      05                             PIC X(05)     VALUE SPACES.     00454700
 C21      05  WS-EMP-PRT-FNAM            PIC X(17).                      00454800
 C21      05                             PIC X(07)     VALUE SPACES.     00454900
 C14      05  WS-EMP-PRT-MID-IN          PIC X(05).                      00455000
 C21      05                             PIC X(59)     VALUE SPACES.     00455100
 C22    01  WS-EMP-PRT-TOTAL-SALARY.                                     00455200
 C22      05                         PIC X(10)  VALUE SPACES.            00455300
 C22      05                         PIC X(20)  VALUE 'TOTAL SALARY='.   00455400
 C22      05                         PIC X(02)  VALUE SPACES.            00455500
       * CHANGE TO $$$$,$$$.99 IF NOT WORKING******************          00455600
 C22      05  WS-EMP-PRT-TOT-SALARY  PIC $$,$$$,$$$.99.                  00455700
 C22      05                         PIC X(90)  VALUE SPACES.            00455800
 C13    01  WS-TRANS-EOF             PIC X(03).                          00455900
 C13    01  WS-TRANS-FILE-STATUS     PIC X(02).                          00456000
 C13    01  WS-TRANS-REC.                                                00456100
 C14      05  WS-TRANS-REC-TRANS-ID           PIC X(2).                  00456200
 C14      05  WS-TRANS-REC-TRANS-NAME         PIC X(5).                  00456300
        LINKAGE SECTION.                                                 00457000
                                                                         00458000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
1                                                                                                              PAGE 0064
 MEMBER NAME  BACKUP23
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
            PERFORM 3000-PROCESS-TRANS-FILE                              00553000
                                                                         00554000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720100
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720200
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720400
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720500
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720600
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720700
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720800
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721300
 C9             END-EVALUATE                                             00721400
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721500
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809100
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809200
 C9             END-EVALUATE                                             00809300
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
1                                                                                                              PAGE 0065
 MEMBER NAME  BACKUP23
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
            END-READ                                                     00960000
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969100
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969200
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969400
 C9         END-EVALUATE                                                 00969500
            .                                                            00970000
        1110-PROCESS-DEPT-FIELDS.                                        00970100
       **********************************************************        00970200
       ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        00970300
       **********************************************************        00970400
            DISPLAY  '1110-PROCESS-DEPT-FIELDS'                          00970500
       **********************************************************        00970600
       ***= GOES AFTER NOT***************************************        00970700
       **********************************************************        00970800
       ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00970900
       **********************************************************        00971000
       ***END WITH "END-IF" STATEMENT****************************        00971100
       **********************************************************        00971200
 C17        IF WS-DEPT-REC-DEPT-NAME NOT = SPACE                         00971300
 C17            DISPLAY 'WS-DEPT-REC ='                                  00971400
 C17                          WS-DEPT-REC                                00971500
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NAME='                         00971600
 C17                          WS-DEPT-REC-DEPT-NAME                      00971700
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NUM='                          00971800
 C17                          WS-DEPT-REC-DEPT-NUM                       00971900
 C17            DISPLAY 'WS-DEPT-REC-MANAGER-NUM='                       00972000
 C17                          WS-DEPT-REC-MANAGER-NUM                    00972100
 C17            DISPLAY 'WS-DEPT-REC-ADMIN-CODE='                        00972200
 C17                          WS-DEPT-REC-ADMIN-CODE                     00972300
            ELSE                                                         00972400
                DISPLAY 'BAD RECORD'                                     00972500
            END-IF                                                       00972600
            .                                                            00972700
 C15   **********************************************************        00972800
  V    *********************************************************         00972900
  |    **********************************************************        00973000
  |     2000-PROCESS-EMP-FILE.                                           00973100
  |    **********************************************************        00973200
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        00973300
1                                                                                                              PAGE 0066
 MEMBER NAME  BACKUP23
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        00974000
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        00975000
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '2000-PROCESS-EMP-FILE'                              00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
            MOVE 0 TO WS-EMP-PRT-PAGE-COUNT                              00979300
            MOVE 50 TO WS-EMP-PRT-LINE-COUNT                             00979400
  |         OPEN INPUT EMP-FILE                                          00979500
  |             EVALUATE WS-EMP-FILE-STATUS                              00979600
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00979700
  |               WHEN '10'          DISPLAY 'END OF FILE'               00979800
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00979900
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00980000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00980100
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00980200
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00980300
  |             END-EVALUATE                                             00980400
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00980500
  |         DISPLAY ' '                                                  00980600
 C22        OPEN OUTPUT EMP-PRT-FILE                                     00980700
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 2100-PROCESS-EMP-REC                                 00982100
  |                   UNTIL WS-EMP-EOF  = 'END'                          00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE EMP-FILE                                               00984000
  |             EVALUATE WS-EMP-FILE-STATUS                              00984100
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00984200
  |               WHEN '10'          DISPLAY 'END OF FILE'               00984300
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00984400
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00984500
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00984600
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00984700
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00984800
  |             END-EVALUATE                                             00984900
  |         DISPLAY ' '                                                  00985000
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00986000
 C22        WRITE EMP-PRT-REC FROM WS-EMP-PRT-TOTAL-SALARY AFTER 2 LINES 00986100
 C22        CLOSE EMP-PRT-FILE                                           00986200
  _         .                                                            00988000
       ***********************************************************       00991300
       ***********************************************************       00991400
       ***********************************************************       00991500
  |                                                                      00991600
  |     2100-PROCESS-EMP-REC.                                            00991700
  |    **********************************************************        00991800
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00991900
  |    **********************************************************        00992000
  |    *    DISPLAY '2100-PROCESS-EMP-REC'                               00992100
  |                                                                      00992200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00992400
1                                                                                                              PAGE 0067
 MEMBER NAME  BACKUP23
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00992500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    00992600
  |         READ EMP-FILE INTO  WS-EMP-REC                               00992700
  |             AT END      MOVE 'END' TO WS-EMP-EOF                     00992800
 C23            NOT AT END  DISPLAY 'WS-EMP-REC ='                       00993000
  V                                    WS-EMP-REC                        00993100
  |    **********************************************************        00993200
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993300
  |    **********************************************************        00993400
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993500
  |    **********************************************************        00993600
  |    ***END WITH "END-IF" STATEMENT****************************        00993700
  |    **********************************************************        00993800
  |         IF WS-EMP-REC-LAST-NAME NOT = SPACE                          00994000
  |             DISPLAY 'WS-EMP-REC ='                                   00995000
  |                        WS-EMP-REC                                    00996000
  |             DISPLAY 'WS-EMP-REC-EMP-NUM='                            00997000
  |                        WS-EMP-REC-EMP-NUM                            00998000
  |             DISPLAY 'WS-EMP-REC-LAST-NAME='                          00999000
  |                        WS-EMP-REC-LAST-NAME                          00999100
  |             DISPLAY 'WS-EMP-REC-FIRST-NAME='                         00999200
  |                        WS-EMP-REC-FIRST-NAME                         00999300
  |             DISPLAY 'WS-EMP-REC-MID-IN='                             00999400
  |                        WS-EMP-REC-MID-IN                             00999500
  |             DISPLAY 'WS-EMP-REC-DEPT-NUM='                           00999600
  |                        WS-EMP-REC-DEPT-NUM                           00999700
  |             DISPLAY 'WS-EMP-REC-JOB-TITLE='                          00999800
  |                        WS-EMP-REC-JOB-TITLE                          00999900
  C21           MOVE    WS-EMP-REC-EMP-SAL TO WS-EMP-SAL                 01000600
  C21           DISPLAY WS-EMP-SAL                                       01000700
  C21           MOVE    WS-EMP-REC-EMP-BONUS TO WS-EMP-BONUS             01000800
  C21           DISPLAY WS-EMP-BONUS                                     01000900
  C21           MOVE    WS-EMP-REC-EMP-COMM TO WS-EMP-COMM               01001000
  C21           DISPLAY WS-EMP-COMM                                      01001100
  |         ELSE                                                         01001300
  |             DISPLAY 'BAD RECORD'                                     01001400
  >         END-IF                                                       01001500
  |         END-READ                                                     01001600
  |             EVALUATE WS-EMP-FILE-STATUS                              01001700
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01001800
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01001900
  |               WHEN '10'          DISPLAY 'END OF FILE'               01002000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01002100
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01002200
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01002300
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01002400
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01002500
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01003000
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01004000
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01005000
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01006000
  |             END-EVALUATE                                             01007000
  |         PERFORM 2110-MOVE-WRITE-EMP-REC                              01007100
  -         .                                                            01008000
 C22    2110-MOVE-WRITE-EMP-REC.                                         01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
1                                                                                                              PAGE 0068
 MEMBER NAME  BACKUP23
  |         DISPLAY  '2110-MOVE-WRITE-EMP-REC'                           01008500
  |         DISPLAY  WS-EMP-REC                                          01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
 C22        IF   WS-EMP-PRT-LINE-COUNT > 11                              01009000
  |         THEN     PERFORM 2112-WRITE-PRT-EMP-HDRS                     01010000
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020000
  |         ELSE                                                         01020100
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
 C22   ****************************************************************  01020500
  |    ****************************************************************  01020700
  |    ****************************************************************  01020800
  |     2111-MOVE-FLDS-WRITE-EMP-DTL.                                    01020900
  |         DISPLAY '2111-MOVE-FLDS-WRITE-EMP-DTL'                       01021000
  |         MOVE  WS-EMP-REC-LAST-NAME  TO WS-EMP-PRT-LNAM               01021100
  |         MOVE  WS-EMP-REC-DEPT-NUM   TO WS-EMP-PRT-DEPT-NUM           01021200
  |         MOVE  WS-EMP-REC-FIRST-NAME TO WS-EMP-PRT-FNAM               01021300
 C23        MOVE  WS-EMP-REC-MID-IN     TO WS-EMP-PRT-MID-IN             01021400
  |         ADD   WS-EMP-REC-EMP-SAL    TO WS-EMP-TOTAL-SALARY           01021500
  |         ADD      1                  TO WS-EMP-PRT-LINE-COUNT         01021600
  |         MOVE  WS-EMP-TOTAL-SALARY   TO WS-EMP-PRT-TOT-SALARY         01021700
  |         WRITE EMP-PRT-REC         FROM WS-EMP-PRT-REC AFTER 2 LINE   01021800
  |         .                                                            01022000
  |     2112-WRITE-PRT-EMP-HDRS.                                         01022100
  |         DISPLAY '2112-WRITE-PRT-EMP-HDRS'                            01022200
  |         ADD          1       TO WS-EMP-PRT-PAGE-COUNT                01022300
  |         MOVE   WS-EMP-PRT-PAGE-COUNT TO WS-EMP-PRT-HDR1-PAGE-COUNT   01022400
  |         MOVE         0       TO WS-EMP-PRT-LINE-COUNT                01022500
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR1 AFTER PAGE         01022600
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR2 AFTER 2 LINES      01022700
  _         .                                                            01022900
 C19   **********************************************************        01023000
  V    *************TRANS FILLE*********************************         01023100
  |    **********************************************************        01023200
  |     3000-PROCESS-TRANS-FILE.                                         01023300
  |    **********************************************************        01023400
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        01023500
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        01023600
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        01023700
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        01024000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        01025000
  |    **********************************************************        01026000
  |         DISPLAY '3000-PROCESS-TRANS-FILE'                            01027000
  |                                                                      01028000
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 01029000
  |         OPEN INPUT TRANS-FILE                                        01029100
  |             EVALUATE WS-TRANS-FILE-STATUS                            01029200
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01029300
  |               WHEN '10'          DISPLAY 'END OF FILE'               01029400
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01029500
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01029600
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01029700
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01029800
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01029900
  |             END-EVALUATE                                             01030000
1                                                                                                              PAGE 0069
 MEMBER NAME  BACKUP23
  |         DISPLAY '**** S-T-A-R-T OF TRANS FILE****'                   01031000
  |         DISPLAY ' '                                                  01032000
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 01033000
  |         MOVE SPACES  TO  WS-TRANS-EOF                                01034000
  |                                                                      01035000
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 01036000
  |         PERFORM 3100-PROCESS-TRANS-REC                               01037000
  |                   UNTIL WS-TRANS-EOF  = 'END'                        01038000
  |                                                                      01039000
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  01039100
  |         CLOSE TRANS-FILE                                             01039200
  |             EVALUATE WS-TRANS-FILE-STATUS                            01039300
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01039400
  |               WHEN '10'          DISPLAY 'END OF FILE'               01039500
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01039600
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01039700
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01039800
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01039900
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01040000
  |             END-EVALUATE                                             01041000
  |         DISPLAY ' '                                                  01042000
  |         DISPLAY '****  E-N-D OF TRANS FILE ****'                     01043000
  |         .                                                            01044000
  |                                                                      01045000
  |     3100-PROCESS-TRANS-REC.                                          01046000
  |    **********************************************************        01047000
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           01048000
  |    **********************************************************        01049000
  |    *    DISPLAY '3100-PROCESS-TRANS-REC'                             01049100
  |                                                                      01049200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    01049300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 01049400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 01049500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    01049600
  |         READ TRANS-FILE INTO  WS-TRANS-REC                           01049700
  |             AT END      MOVE 'END' TO WS-TRANS-EOF                   01049800
  |             NOT AT END  PERFORM 3110-PROCESS-TRANS-FIELDS            01049900
  |         END-READ                                                     01050000
  |             EVALUATE WS-TRANS-FILE-STATUS                            01051000
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01052000
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01053000
  |               WHEN '10'          DISPLAY 'END OF FILE'               01054000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01055000
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01056000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01057000
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01058000
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01059000
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01059100
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01059200
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01059300
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01059400
  |             END-EVALUATE                                             01059500
  -         .                                                            01059600
 C19    3110-PROCESS-TRANS-FIELDS.                                       01059700
  V    **********************************************************        01059800
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01059900
  |    **********************************************************        01060000
  |    *    DISPLAY  '3110-PROCESS-TRANS-FIELDS'                         01061000
1                                                                                                              PAGE 0070
 MEMBER NAME  BACKUP23
  |    **********************************************************        01062000
  |    ***= GOES AFTER NOT***************************************        01063000
  |    **********************************************************        01064000
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01065000
  |    **********************************************************        01066000
  |    ***END WITH "END-IF" STATEMENT****************************        01067000
  |    **********************************************************        01068000
  |    *    IF WS-TRANS-REC-TRANS-ID NOT = SPACE                         01069000
  |    *        DISPLAY 'WS-TRAS-REC ='                                  01069100
  |    *                   WS-TRANS-REC                                  01069200
  |    *        DISPLAY 'WS-TRANS-REC-TRANS-ID='                         01069300
  |    *                   WS-TRANS-REC-TRANS-ID                         01069400
  |    *        DISPLAY 'WS-EMP-REC-TRANS-NAME='                         01069500
  |    *                   WS-TRANS-REC-TRANS-NAME                       01069600
  |    **   ELSE                                                         01079200
  |    *        DISPLAY 'INVALAD RECORD'                                 01079300
  |    *    END-IF                                                       01079400
 C20        EVALUATE WS-TRANS-REC-TRANS-ID                               01079500
  |           WHEN SPACE          DISPLAY  'INVALAD TRANS'               01079600
  |           WHEN OTHER          DISPLAY 'WS-TRAS-REC ='                01079700
  |                                          WS-TRANS-REC                01079800
  |                               DISPLAY 'WS-TRANS-REC-TRANS-ID='       01079900
  |                                          WS-TRANS-REC-TRANS-ID       01080000
  |                               DISPLAY 'WS-EMP-REC-TRANS-NAME='       01080100
  |                                          WS-TRANS-REC-TRANS-NAME     01080200
  _         .                                                            01081000
       ********  END OF PROGRAM    COBSHEL ***********************       01090000
1                                                                                                              PAGE 0071
 MEMBER NAME  COBCALL
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 CNN   *    CNN    IN COLUMNS 1-3                                        00100000
       ***************************************************************** 00110000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
       **********************************************************        00270000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-PARM1             PIC X(14).                              00430001
        LINKAGE SECTION.                                                 00450000
                                                                         00460000
        PROCEDURE DIVISION.                                              00470000
 C1         DISPLAY 'COBCALL BEFORE'.                                    00471001
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00472000
        0000-MAIN.                                                       00473000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00474000
1                                                                                                              PAGE 0072
 MEMBER NAME  COBCLG
 //TRAIN05X JOB 43312,'MAINTEC',                                         00010004
 //             CLASS=A,MSGCLASS=X,MSGLEVEL=(1,1),NOTIFY=&SYSUID         00020004
 //JOBPROC JCLLIB ORDER=TRAIN00.CLASS.COBOL                              00030004
 //********************************************************************  00031006
 //*** I-P-O  I(INPUT)   P(PROCESS)   O(OUTPUT)************************  00032009
 //*** I - //COBOL.SYSIN DSN= COBOL PROGRAM STORED IN MEMBER***********  00033009
 //***     //DEPTFILE DNS= LOCATION TO LOOK FOR DEPTFILE***************  00033109
 //*** P - COBCL IGYWCL COBOL COMPILER*********************************  00034009
 //*** O - DD SYSPRINT=* PRINT TO JES2*********************************  00036009
 //********************************************************************  00037006
 //COBCL   EXEC IGYWCL,                                                  00040004
 //             PGMLIB=TRAIN05.CLASS.LOADLIB,      --> LOADLIB NAME      00050011
 //             COPYLIB=TRAIN05.CLASS.COBOL,       --> COPYLIB NAME      00060008
 //             GOPGM=COBSHEL                       --> MEMBER NAME      00070004
 //COBOL.SYSIN DD DSN=TRAIN05.CLASS.COBOL(COBSHEL),DISP=SHR   -->SRC     00080008
 //**********************************************************            00090004
 //RUN     EXEC PGM=COBSHEL,COND=(5,LT),PARM='2023-11-15' MEM NAME       00100020
 //STEPLIB   DD DSN=TRAIN05.CLASS.LOADLIB,DISP=SHR -> LOADLIB NAME       00110008
 //SYSOUT    DD SYSOUT=*,OUTLIM=1000                                     00120013
 //DEPTFILE  DD DSN=TRAIN00.CLASS.DEPTFILE,DISP=SHR                      00130008
 //EMPFILE   DD DSN=TRAIN00.CLASS.EMPFILE,DISP=SHR                       00140012
 //TRANS     DD DSN=TRAIN05.CLASS.TRANS,DISP=SHR                         00150016
 //PRINTEMP  DD SYSOUT=*,OUTLIM=1000                                     00160017
1                                                                                                              PAGE 0073
 MEMBER NAME  BACKUP24
        IDENTIFICATION DIVISION.                                         00010000
        PROGRAM-ID.       COBSHEL.                                       00020000
       ***************************************************************** 00030000
       ***********    CHANGE LOG   ************************************* 00040000
       *---------------------------------------------------------------* 00050000
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060000
       *---------------------------------------------------------------* 00070000
       *    NONE          10-23      ORIGINAL CODE                       00080000
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090000
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100000
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101000
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102000
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103000
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104000
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105000
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105100
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106000
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107000
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108000
 C12   *    C12           10-27      DEFINE EMP FILE                     00109000
 C13   *    C13           10-27      DEFINE EMP FILE STATUS CHAR LENGHT  00109100
 C14   *    C14           10-27      ADD EMP INDIVIDUAL FIELDS           00109200
 C15   *    C15           10-27      REPEAT DEPTFILE AS EMP FILE PROCESS 00109300
 C16   *    C16           10-27      MOVE END READ DISPLAY TO 1110       00109400
 C17   *    C17           10-30      DEPTFILE EDIT BLANKS                00109500
 C18   *    C18           10-31      EMPFILE EDIT BLANKS                 00109600
 C19   *    C19           11-01      PROCESS TRANS-FILE IF STATEMENT     00109700
 C20   *    C20           11-01      PROCESS TRANS-FILE EVALUATE         00109800
 C21   *    C21           11-01      EMP FILE NUMERICS                   00109900
 C22   *    C22           11-08      EMP PRINT FILE                      00110000
 C23   *    C23           11-10      REST OF EMP DATA                    00110100
 C24   *    C24           11-15      PRINT PARM FROM JCL                 00110200
       ***************************************************************** 00111000
       *******  PROGRAM STRUCTURE    *********************************** 00120000
       ***************************************************************** 00130000
       *** 0000-MAIN.                                                    00140000
       *** 1000-PROCESS-DEPT-FILE                                        00150000
       ***     OPEN DEPT-FILE                                            00160000
       ***         1100-PROCESS-DEPT-REC                                 00170000
       ***     CLOSE DEPT-FILE                                           00180000
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190000
       *** 2000-PROCESS-EMP-FILE                                         00191000
       ***     OPEN EMP-FILE                                             00192000
       ***         2100-PROCESS-EMP-REC                                  00193000
       ***     CLOSE EMP-FILE                                            00194000
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195000
       *** 3000-PROCESS-TRANS-FILE                                       00196000
       ***     OPEN TRANS-FILE                                           00197000
       ***         3100-PROCESS-TRANS-REC                                00198000
       ***     CLOSE TRANS-FILE                                          00199000
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199100
       ***************************************************************** 00200000
        ENVIRONMENT DIVISION.                                            00210000
        INPUT-OUTPUT SECTION.                                            00220000
        FILE-CONTROL.                                                    00230000
       **********************************************************        00240000
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250000
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260000
1                                                                                                              PAGE 0074
 MEMBER NAME  BACKUP24
       **********************************************************        00270000
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280000
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281000
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282000
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283000
 C22        SELECT EMP-PRT-FILE ASSIGN TO PRINTEMP.                      00284000
 C19        SELECT TRANS-FILE   ASSIGN TO TRANS                          00286000
 C19              FILE STATUS IS WS-TRANS-FILE-STATUS.                   00287000
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290000
        DATA DIVISION.                                                   00300000
        FILE SECTION.                                                    00310000
                                                                         00320000
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330000
        FD  DEPT-FILE                                                    00340000
            RECORD CONTAINS 80 CHARACTERS                                00350000
            BLOCK  CONTAINS  0 RECORDS                                   00360000
            RECORDING  MODE IS F.                                        00370000
        01  DEPT-REC         PIC X(80).                                  00380000
       * EMP-FILE DEFINITION                                             00380100
 C12    FD  EMP-FILE                                                     00381000
 C12        RECORD CONTAINS 80 CHARACTERS                                00382000
 C12        BLOCK  CONTAINS  0 RECORDS                                   00383000
 C12        RECORDING  MODE IS F.                                        00384000
 C12    01  EMP-REC          PIC X(80).                                  00385000
       * EMP-PRT-FILE DEFINITION                                         00385100
 C22    FD  EMP-PRT-FILE                                                 00385200
 C22        RECORD CONTAINS 133 CHARACTERS                               00385300
 C22        BLOCK  CONTAINS  0 RECORDS                                   00385400
 C22        RECORDING  MODE IS F.                                        00385500
 C22    01  EMP-PRT-REC      PIC X(133).                                 00385600
       * TRANS-FILE DEFINITION                                           00386200
 C19    FD  TRANS-FILE                                                   00386300
 C19        RECORD CONTAINS 80 CHARACTERS                                00387000
 C19        BLOCK  CONTAINS  0 RECORDS                                   00388000
 C19        RECORDING  MODE IS F.                                        00389000
 C19    01  TRANS-REC          PIC X(80).                                00389100
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390000
                                                                         00400000
        WORKING-STORAGE SECTION.                                         00410000
       ********* WS - OUR DATA NAMES *******************                 00420000
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430000
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431000
        01  WS-DEPT-REC.                                                 00440000
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441000
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442000
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443000
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444000
 C5       05                               PIC X(32).                    00445000
 C13    01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446000
 C13    01  WS-EMP-FILE-STATUS  PIC X(02).                               00447000
 C13    01  WS-EMP-REC.                                                  00448000
 C14      05  WS-EMP-REC-EMP-NUM         PIC X(6).                       00449000
 C14      05  WS-EMP-REC-LAST-NAME       PIC X(15).                      00449100
 C14      05  WS-EMP-REC-FIRST-NAME      PIC X(12).                      00449200
 C14      05  WS-EMP-REC-MID-IN          PIC X(1).                       00449300
 C14      05  WS-EMP-REC-DEPT-NUM        PIC X(3).                       00449400
 C14      05  WS-EMP-REC-JOB-TITLE       PIC X(11).                      00449500
 C14      05  WS-EMP-REC-EMP-SAL         PIC 9(5)V99.                    00449600
1                                                                                                              PAGE 0075
 MEMBER NAME  BACKUP24
 C14      05  WS-EMP-REC-EMP-BONUS       PIC 9(5)V99.                    00449700
 C14      05  WS-EMP-REC-EMP-COMM        PIC 9(5)V99.                    00449800
 C14      05  FILLER                     PIC X(07).                      00449901
 C21    01  WS-EMP-SAL              PIC $9(5).99.                        00450001
 C21    01  WS-EMP-BONUS            PIC $9(5).99.                        00450101
 C21    01  WS-EMP-COMM             PIC $9(5).99.                        00451000
 C22    01  WS-EMP-TOTAL-SALARY     PIC 9(7)V9(2).                       00451400
 C22    01  WS-EMP-PRT-LINE-COUNT    PIC 9(2)     VALUE 0.               00451500
 C22    01  WS-EMP-PRT-PAGE-COUNT    PIC 9(5)     VALUE 0.               00451600
 C22    01  WS-EMP-PRT-HDR1.                                             00451900
 C22      05  FILLER                PIC X(20)     VALUE SPACES.          00452000
 C22      05                        PIC X(22) VALUE '-ABC CONSULTING-'.  00452100
 C22      05                        PIC X(20)     VALUE SPACES.          00452200
 C22      05                        PIC X(10)     VALUE 'PAGE NO:'.      00452300
 C22      05  WS-EMP-PRT-HDR1-PAGE-COUNT  PIC ZZZZ9.                     00452400
 C22      05                        PIC X(21)     VALUE SPACES.          00452500
 C22    01  WS-EMP-PRT-HDR2.                                             00452800
 C23      05                         PIC X(05)      VALUE SPACES.        00453100
 C23      05                         PIC X(15) VALUE 'D E P T N U M .'.  00453200
 C22      05                         PIC X(05)      VALUE SPACES.        00453300
 C22      05                         PIC X(15) VALUE 'L A S T N A M E'.  00453400
 C22      05                         PIC X(05)      VALUE SPACES.        00453500
 C22      05                         PIC X(17)                           00453600
 C22                                         VALUE 'F I R S T N A M E'.  00453700
 C22      05                         PIC X(05)      VALUE SPACES.        00453800
 C22      05                         PIC X(05)                           00453900
 C22                                         VALUE 'M . I'.              00454000
 C22      05                         PIC X(61)     VALUE SPACES.         00454100
 C21    01  WS-EMP-PRT-REC.                                              00454200
 C21      05                             PIC X(05)     VALUE SPACES.     00454300
 C21      05  WS-EMP-PRT-DEPT-NUM        PIC X(15).                      00454400
 C21      05                             PIC X(05)     VALUE SPACES.     00454500
 C21      05  WS-EMP-PRT-LNAM            PIC X(15).                      00454600
 C21      05                             PIC X(05)     VALUE SPACES.     00454700
 C21      05  WS-EMP-PRT-FNAM            PIC X(17).                      00454800
 C21      05                             PIC X(07)     VALUE SPACES.     00454900
 C14      05  WS-EMP-PRT-MID-IN          PIC X(05).                      00455000
 C21      05                             PIC X(59)     VALUE SPACES.     00455100
 C22    01  WS-EMP-PRT-TOTAL-SALARY.                                     00455200
 C22      05                         PIC X(10)  VALUE SPACES.            00455300
 C22      05                         PIC X(20)  VALUE 'TOTAL SALARY='.   00455400
 C22      05                         PIC X(02)  VALUE SPACES.            00455500
       * CHANGE TO $$$$,$$$.99 IF NOT WORKING******************          00455600
 C22      05  WS-EMP-PRT-TOT-SALARY  PIC $$,$$$,$$$.99.                  00455700
 C22      05                         PIC X(90)  VALUE SPACES.            00455800
 C13    01  WS-TRANS-EOF             PIC X(03).                          00455900
 C13    01  WS-TRANS-FILE-STATUS     PIC X(02).                          00456000
 C13    01  WS-TRANS-REC.                                                00456100
 C14      05  WS-TRANS-REC-TRANS-ID           PIC X(2).                  00456200
 C14      05  WS-TRANS-REC-TRANS-NAME         PIC X(5).                  00456300
        LINKAGE SECTION.                                                 00457000
       ** //RUN     EXEC PGM=COBSHEL,COND=(5,LT),PARM='2023-11-15'*****  00458000
 C24    01 LS-PARM-FROM-JCL.                                             00459000
 C24        05 LS-PARM-LENGTH        PIC S9(04)  COMP.                   00460000
 C24        05 LS-PARM-DATA-FROM-JCL PIC X(10).                          00461000
        PROCEDURE DIVISION USING LS-PARM-FROM-JCL.                       00470000
 C1         DISPLAY 'REGINALD TRAIN05'.                                  00471000
 C24        DISPLAY 'JCL PARMS FOLLOW ..........'                        00472000
1                                                                                                              PAGE 0076
 MEMBER NAME  BACKUP24
 C24        DISPLAY 'LS-PARM-LENGHT=' LS-PARM-LENGTH                     00473000
 C24        DISPLAY 'LS-PARM-DATA-FROM-JCL=' LS-PARM-DATA-FROM-JCL       00474000
 C24                                                                     00475000
 C24        GOBACK                                                       00475100
 C24        .                                                            00476000
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480000
        0000-MAIN.                                                       00490000
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500000
            DISPLAY '0000-MAIN'                                          00510000
                                                                         00520000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530000
            PERFORM 1000-PROCESS-DEPT-FILE                               00540000
                                                                         00550000
            PERFORM 2000-PROCESS-EMP-FILE                                00551000
                                                                         00552000
            PERFORM 3000-PROCESS-TRANS-FILE                              00553000
                                                                         00554000
       ********* GOBACK - RETURN TO Z/OS ****************                00560000
            GOBACK                                                       00570000
            .                                                            00580000
                                                                         00590000
                                                                         00600000
        1000-PROCESS-DEPT-FILE.                                          00610000
       **********************************************************        00620000
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630000
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640000
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650000
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660000
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670000
       **********************************************************        00680000
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690000
                                                                         00700000
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710000
            OPEN INPUT DEPT-FILE                                         00720000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720100
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720200
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720400
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720500
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720600
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720700
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720800
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721300
 C9             END-EVALUATE                                             00721400
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721500
 C4         DISPLAY ' '                                                  00722000
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730000
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740000
                                                                         00750000
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760000
            PERFORM 1100-PROCESS-DEPT-REC                                00770000
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771000
                                                                         00780000
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790000
            CLOSE DEPT-FILE                                              00800000
 C4         DISPLAY ' '                                                  00802000
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803000
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805000
1                                                                                                              PAGE 0077
 MEMBER NAME  BACKUP24
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809000
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809100
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809200
 C9             END-EVALUATE                                             00809300
            .                                                            00810000
                                                                         00820000
        1100-PROCESS-DEPT-REC.                                           00830000
       **********************************************************        00840000
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850000
       **********************************************************        00860000
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870000
                                                                         00880000
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890000
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900000
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910000
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920000
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930000
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940000
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950000
       *******DISPLAY INDIVIDUAL FIELDS********************************  00950100
            END-READ                                                     00960000
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961000
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962000
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963000
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964000
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965000
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966000
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967000
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969100
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969200
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969400
 C9         END-EVALUATE                                                 00969500
            .                                                            00970000
        1110-PROCESS-DEPT-FIELDS.                                        00970100
       **********************************************************        00970200
       ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        00970300
       **********************************************************        00970400
            DISPLAY  '1110-PROCESS-DEPT-FIELDS'                          00970500
       **********************************************************        00970600
       ***= GOES AFTER NOT***************************************        00970700
       **********************************************************        00970800
       ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00970900
       **********************************************************        00971000
       ***END WITH "END-IF" STATEMENT****************************        00971100
       **********************************************************        00971200
 C17        IF WS-DEPT-REC-DEPT-NAME NOT = SPACE                         00971300
 C17            DISPLAY 'WS-DEPT-REC ='                                  00971400
 C17                          WS-DEPT-REC                                00971500
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NAME='                         00971600
 C17                          WS-DEPT-REC-DEPT-NAME                      00971700
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NUM='                          00971800
 C17                          WS-DEPT-REC-DEPT-NUM                       00971900
 C17            DISPLAY 'WS-DEPT-REC-MANAGER-NUM='                       00972000
 C17                          WS-DEPT-REC-MANAGER-NUM                    00972100
 C17            DISPLAY 'WS-DEPT-REC-ADMIN-CODE='                        00972200
1                                                                                                              PAGE 0078
 MEMBER NAME  BACKUP24
 C17                          WS-DEPT-REC-ADMIN-CODE                     00972300
            ELSE                                                         00972400
                DISPLAY 'BAD RECORD'                                     00972500
            END-IF                                                       00972600
            .                                                            00972700
 C15   **********************************************************        00972800
  V    *********************************************************         00972900
  |    **********************************************************        00973000
  |     2000-PROCESS-EMP-FILE.                                           00973100
  |    **********************************************************        00973200
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        00973300
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        00974000
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        00975000
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        00976000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977000
  |    **********************************************************        00978000
  |         DISPLAY '2000-PROCESS-EMP-FILE'                              00979000
  |                                                                      00979100
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979200
            MOVE 0 TO WS-EMP-PRT-PAGE-COUNT                              00979300
            MOVE 50 TO WS-EMP-PRT-LINE-COUNT                             00979400
  |         OPEN INPUT EMP-FILE                                          00979500
  |             EVALUATE WS-EMP-FILE-STATUS                              00979600
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00979700
  |               WHEN '10'          DISPLAY 'END OF FILE'               00979800
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00979900
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00980000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00980100
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00980200
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00980300
  |             END-EVALUATE                                             00980400
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00980500
  |         DISPLAY ' '                                                  00980600
 C22        OPEN OUTPUT EMP-PRT-FILE                                     00980700
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00981700
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00981800
  |                                                                      00981900
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982000
  |         PERFORM 2100-PROCESS-EMP-REC                                 00982100
  |                   UNTIL WS-EMP-EOF  = 'END'                          00982200
  |                                                                      00982300
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983000
  |         CLOSE EMP-FILE                                               00984000
  |             EVALUATE WS-EMP-FILE-STATUS                              00984100
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00984200
  |               WHEN '10'          DISPLAY 'END OF FILE'               00984300
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00984400
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00984500
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00984600
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00984700
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00984800
  |             END-EVALUATE                                             00984900
  |         DISPLAY ' '                                                  00985000
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00986000
 C22        WRITE EMP-PRT-REC FROM WS-EMP-PRT-TOTAL-SALARY AFTER 2 LINES 00986100
 C22        CLOSE EMP-PRT-FILE                                           00986200
  _         .                                                            00988000
       ***********************************************************       00991300
1                                                                                                              PAGE 0079
 MEMBER NAME  BACKUP24
       ***********************************************************       00991400
       ***********************************************************       00991500
  |                                                                      00991600
  |     2100-PROCESS-EMP-REC.                                            00991700
  |    **********************************************************        00991800
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00991900
  |    **********************************************************        00992000
  |    *    DISPLAY '2100-PROCESS-EMP-REC'                               00992100
  |                                                                      00992200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00992300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00992400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00992500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    00992600
  |         READ EMP-FILE INTO  WS-EMP-REC                               00992700
  |             AT END      MOVE 'END' TO WS-EMP-EOF                     00992800
 C23            NOT AT END  DISPLAY 'WS-EMP-REC ='                       00993000
  V                                    WS-EMP-REC                        00993100
  |    **********************************************************        00993200
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993300
  |    **********************************************************        00993400
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993500
  |    **********************************************************        00993600
  |    ***END WITH "END-IF" STATEMENT****************************        00993700
  |    **********************************************************        00993800
  |         IF WS-EMP-REC-LAST-NAME NOT = SPACE                          00994000
  |             DISPLAY 'WS-EMP-REC ='                                   00995000
  |                        WS-EMP-REC                                    00996000
  |             DISPLAY 'WS-EMP-REC-EMP-NUM='                            00997000
  |                        WS-EMP-REC-EMP-NUM                            00998000
  |             DISPLAY 'WS-EMP-REC-LAST-NAME='                          00999000
  |                        WS-EMP-REC-LAST-NAME                          00999100
  |             DISPLAY 'WS-EMP-REC-FIRST-NAME='                         00999200
  |                        WS-EMP-REC-FIRST-NAME                         00999300
  |             DISPLAY 'WS-EMP-REC-MID-IN='                             00999400
  |                        WS-EMP-REC-MID-IN                             00999500
  |             DISPLAY 'WS-EMP-REC-DEPT-NUM='                           00999600
  |                        WS-EMP-REC-DEPT-NUM                           00999700
  |             DISPLAY 'WS-EMP-REC-JOB-TITLE='                          00999800
  |                        WS-EMP-REC-JOB-TITLE                          00999900
  C21           MOVE    WS-EMP-REC-EMP-SAL TO WS-EMP-SAL                 01000600
  C21           DISPLAY WS-EMP-SAL                                       01000700
  C21           MOVE    WS-EMP-REC-EMP-BONUS TO WS-EMP-BONUS             01000800
  C21           DISPLAY WS-EMP-BONUS                                     01000900
  C21           MOVE    WS-EMP-REC-EMP-COMM TO WS-EMP-COMM               01001000
  C21           DISPLAY WS-EMP-COMM                                      01001100
  |         ELSE                                                         01001300
  |             DISPLAY 'BAD RECORD'                                     01001400
  >         END-IF                                                       01001500
  |         END-READ                                                     01001600
  |             EVALUATE WS-EMP-FILE-STATUS                              01001700
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01001800
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01001900
  |               WHEN '10'          DISPLAY 'END OF FILE'               01002000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01002100
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01002200
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01002300
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01002400
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01002500
1                                                                                                              PAGE 0080
 MEMBER NAME  BACKUP24
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01003000
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01004000
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01005000
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01006000
  |             END-EVALUATE                                             01007000
  |         PERFORM 2110-MOVE-WRITE-EMP-REC                              01007100
  -         .                                                            01008000
 C22    2110-MOVE-WRITE-EMP-REC.                                         01008100
  V    **********************************************************        01008200
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008300
  |    **********************************************************        01008400
  |         DISPLAY  '2110-MOVE-WRITE-EMP-REC'                           01008500
  |         DISPLAY  WS-EMP-REC                                          01008600
  V    **********************************************************        01008700
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008800
  |    **********************************************************        01008900
 C22        IF   WS-EMP-PRT-LINE-COUNT > 11                              01009000
  |         THEN     PERFORM 2112-WRITE-PRT-EMP-HDRS                     01010000
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020000
  |         ELSE                                                         01020100
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020200
  |         END-IF                                                       01020300
  _         .                                                            01020400
 C22   ****************************************************************  01020500
  |    ****************************************************************  01020700
  |    ****************************************************************  01020800
  |     2111-MOVE-FLDS-WRITE-EMP-DTL.                                    01020900
  |         DISPLAY '2111-MOVE-FLDS-WRITE-EMP-DTL'                       01021000
  |         MOVE  WS-EMP-REC-LAST-NAME  TO WS-EMP-PRT-LNAM               01021100
  |         MOVE  WS-EMP-REC-DEPT-NUM   TO WS-EMP-PRT-DEPT-NUM           01021200
  |         MOVE  WS-EMP-REC-FIRST-NAME TO WS-EMP-PRT-FNAM               01021300
 C23        MOVE  WS-EMP-REC-MID-IN     TO WS-EMP-PRT-MID-IN             01021400
  |         ADD   WS-EMP-REC-EMP-SAL    TO WS-EMP-TOTAL-SALARY           01021500
  |         ADD      1                  TO WS-EMP-PRT-LINE-COUNT         01021600
  |         MOVE  WS-EMP-TOTAL-SALARY   TO WS-EMP-PRT-TOT-SALARY         01021700
  |         WRITE EMP-PRT-REC         FROM WS-EMP-PRT-REC AFTER 2 LINE   01021800
  |         .                                                            01022000
  |     2112-WRITE-PRT-EMP-HDRS.                                         01022100
  |         DISPLAY '2112-WRITE-PRT-EMP-HDRS'                            01022200
  |         ADD          1       TO WS-EMP-PRT-PAGE-COUNT                01022300
  |         MOVE   WS-EMP-PRT-PAGE-COUNT TO WS-EMP-PRT-HDR1-PAGE-COUNT   01022400
  |         MOVE         0       TO WS-EMP-PRT-LINE-COUNT                01022500
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR1 AFTER PAGE         01022600
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR2 AFTER 2 LINES      01022700
  _         .                                                            01022900
 C19   **********************************************************        01023000
  V    *************TRANS FILLE*********************************         01023100
  |    **********************************************************        01023200
  |     3000-PROCESS-TRANS-FILE.                                         01023300
  |    **********************************************************        01023400
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        01023500
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        01023600
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        01023700
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        01024000
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        01025000
  |    **********************************************************        01026000
  |         DISPLAY '3000-PROCESS-TRANS-FILE'                            01027000
  |                                                                      01028000
1                                                                                                              PAGE 0081
 MEMBER NAME  BACKUP24
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 01029000
  |         OPEN INPUT TRANS-FILE                                        01029100
  |             EVALUATE WS-TRANS-FILE-STATUS                            01029200
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01029300
  |               WHEN '10'          DISPLAY 'END OF FILE'               01029400
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01029500
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01029600
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01029700
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01029800
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01029900
  |             END-EVALUATE                                             01030000
  |         DISPLAY '**** S-T-A-R-T OF TRANS FILE****'                   01031000
  |         DISPLAY ' '                                                  01032000
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 01033000
  |         MOVE SPACES  TO  WS-TRANS-EOF                                01034000
  |                                                                      01035000
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 01036000
  |         PERFORM 3100-PROCESS-TRANS-REC                               01037000
  |                   UNTIL WS-TRANS-EOF  = 'END'                        01038000
  |                                                                      01039000
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  01039100
  |         CLOSE TRANS-FILE                                             01039200
  |             EVALUATE WS-TRANS-FILE-STATUS                            01039300
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01039400
  |               WHEN '10'          DISPLAY 'END OF FILE'               01039500
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01039600
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01039700
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01039800
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01039900
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01040000
  |             END-EVALUATE                                             01041000
  |         DISPLAY ' '                                                  01042000
  |         DISPLAY '****  E-N-D OF TRANS FILE ****'                     01043000
  |         .                                                            01044000
  |                                                                      01045000
  |     3100-PROCESS-TRANS-REC.                                          01046000
  |    **********************************************************        01047000
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           01048000
  |    **********************************************************        01049000
  |    *    DISPLAY '3100-PROCESS-TRANS-REC'                             01049100
  |                                                                      01049200
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    01049300
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 01049400
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 01049500
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    01049600
  |         READ TRANS-FILE INTO  WS-TRANS-REC                           01049700
  |             AT END      MOVE 'END' TO WS-TRANS-EOF                   01049800
  |             NOT AT END  PERFORM 3110-PROCESS-TRANS-FIELDS            01049900
  |         END-READ                                                     01050000
  |             EVALUATE WS-TRANS-FILE-STATUS                            01051000
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01052000
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01053000
  |               WHEN '10'          DISPLAY 'END OF FILE'               01054000
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01055000
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01056000
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01057000
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01058000
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01059000
1                                                                                                              PAGE 0082
 MEMBER NAME  BACKUP24
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01059100
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01059200
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01059300
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01059400
  |             END-EVALUATE                                             01059500
  -         .                                                            01059600
 C19    3110-PROCESS-TRANS-FIELDS.                                       01059700
  V    **********************************************************        01059800
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01059900
  |    **********************************************************        01060000
  |    *    DISPLAY  '3110-PROCESS-TRANS-FIELDS'                         01061000
  |    **********************************************************        01062000
  |    ***= GOES AFTER NOT***************************************        01063000
  |    **********************************************************        01064000
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01065000
  |    **********************************************************        01066000
  |    ***END WITH "END-IF" STATEMENT****************************        01067000
  |    **********************************************************        01068000
  |    *    IF WS-TRANS-REC-TRANS-ID NOT = SPACE                         01069000
  |    *        DISPLAY 'WS-TRAS-REC ='                                  01069100
  |    *                   WS-TRANS-REC                                  01069200
  |    *        DISPLAY 'WS-TRANS-REC-TRANS-ID='                         01069300
  |    *                   WS-TRANS-REC-TRANS-ID                         01069400
  |    *        DISPLAY 'WS-EMP-REC-TRANS-NAME='                         01069500
  |    *                   WS-TRANS-REC-TRANS-NAME                       01069600
  |    **   ELSE                                                         01079200
  |    *        DISPLAY 'INVALAD RECORD'                                 01079300
  |    *    END-IF                                                       01079400
 C20        EVALUATE WS-TRANS-REC-TRANS-ID                               01079500
  |           WHEN SPACE          DISPLAY  'INVALAD TRANS'               01079600
  |           WHEN OTHER          DISPLAY 'WS-TRAS-REC ='                01079700
  |                                          WS-TRANS-REC                01079800
  |                               DISPLAY 'WS-TRANS-REC-TRANS-ID='       01079900
  |                                          WS-TRANS-REC-TRANS-ID       01080000
  |                               DISPLAY 'WS-EMP-REC-TRANS-NAME='       01080100
  |                                          WS-TRANS-REC-TRANS-NAME     01080200
  _         .                                                            01081000
       ********  END OF PROGRAM    COBSHEL ***********************       01090000
1                                                                                                              PAGE 0083
 MEMBER NAME  COBSHEL
        IDENTIFICATION DIVISION.                                         00010001
        PROGRAM-ID.       COBSHEL.                                       00020002
       ***************************************************************** 00030002
       ***********    CHANGE LOG   ************************************* 00040002
       *---------------------------------------------------------------* 00050002
       ** CHANGE NUMBER    DATE      DESCIPTION                        * 00060002
       *---------------------------------------------------------------* 00070002
       *    NONE          10-23      ORIGINAL CODE                       00080004
 C1    *    C1            10-24      ADD DISPLAY OF USER NAME            00090004
 C2    *    C2            10-24      ADD PERFORM UNTIL FOR DEPT FILE     00100005
 C3    *    C3            10-26      COMMENT OUT DISPLAY 1100            00101006
 C4    *    C4            10-26      ADD DISPLAY:START/END OF DEPTFILE   00102007
 C5    *    C5            10-27      ADD INDIVIDUAL FIELDS OF WHOLE REC  00103010
 C6    *    C6            10-27      ADD DISPLAY OF INDIVIDUAL FIELDS    00104011
 C7    *    C7            10-27      ADD FILE STATUS DEFINITION          00105014
 C8    *    C8            10-27      ADD FILE STATUS TO WORKING STORAGE  00105116
 C9    *    C9            10-27      ADD FILE STATUS DISPLAY: O,R,C      00106025
 C10   *    C10           10-27      ASIGN EMPFILE TO EMP-FILE           00107020
 C11   *    C11           10-27      ADD EMP-FILE STATUS DEFINITION      00108042
 C12   *    C12           10-27      DEFINE EMP FILE                     00109020
 C13   *    C13           10-27      DEFINE EMP FILE STATUS CHAR LENGHT  00109122
 C14   *    C14           10-27      ADD EMP INDIVIDUAL FIELDS           00109222
 C15   *    C15           10-27      REPEAT DEPTFILE AS EMP FILE PROCESS 00109322
 C16   *    C16           10-27      MOVE END READ DISPLAY TO 1110       00109425
 C17   *    C17           10-30      DEPTFILE EDIT BLANKS                00109528
 C18   *    C18           10-31      EMPFILE EDIT BLANKS                 00109628
 C19   *    C19           11-01      PROCESS TRANS-FILE IF STATEMENT     00109739
 C20   *    C20           11-01      PROCESS TRANS-FILE EVALUATE         00109839
 C21   *    C21           11-01      EMP FILE NUMERICS                   00109942
 C22   *    C22           11-08      EMP PRINT FILE                      00110042
 C23   *    C23           11-10      REST OF EMP DATA                    00110159
 C24   *    C24           11-15      PRINT PARM FROM JCL                 00110257
 C25   *    C25           11-15      CALL FROM SUB PGM                   00110360
       ***************************************************************** 00111041
       *******  PROGRAM STRUCTURE    *********************************** 00120002
       ***************************************************************** 00130002
       *** 0000-MAIN.                                                    00140002
       *** 1000-PROCESS-DEPT-FILE                                        00150002
       ***     OPEN DEPT-FILE                                            00160002
       ***         1100-PROCESS-DEPT-REC                                 00170002
       ***     CLOSE DEPT-FILE                                           00180002
       *** 1110-PROCESS-DEPT-REC-DETAILS                                 00190002
       *** 2000-PROCESS-EMP-FILE                                         00191020
       ***     OPEN EMP-FILE                                             00192020
       ***         2100-PROCESS-EMP-REC                                  00193020
       ***     CLOSE EMP-FILE                                            00194020
       *** 2110-PROCESS-EMP-REC-DETAILS                                  00195020
       *** 3000-PROCESS-TRANS-FILE                                       00196029
       ***     OPEN TRANS-FILE                                           00197029
       ***         3100-PROCESS-TRANS-REC                                00198029
       ***     CLOSE TRANS-FILE                                          00199029
       *** 3110-PROCESS-TRANS-REC-DETAILS                                00199129
       ***************************************************************** 00200002
        ENVIRONMENT DIVISION.                                            00210002
        INPUT-OUTPUT SECTION.                                            00220002
        FILE-CONTROL.                                                    00230002
       **********************************************************        00240002
       **  THE DD NAME FOR THE DEPARTMENT FILE IS DEPTFILE   ****        00250002
1                                                                                                              PAGE 0084
 MEMBER NAME  COBSHEL
       **  LOOK FOR //DEPTFILE  DD  DSN= . . .  IN THE JCL   ****        00260002
       **********************************************************        00270002
            SELECT DEPT-FILE    ASSIGN TO DEPTFILE                       00280039
 C7               FILE STATUS IS WS-DEPT-FILE-STATUS.                    00281019
 C10        SELECT EMP-FILE     ASSIGN TO EMPFILE                        00282039
 C11              FILE STATUS IS WS-EMP-FILE-STATUS.                     00283020
 C22        SELECT EMP-PRT-FILE ASSIGN TO PRINTEMP.                      00284047
 C19        SELECT TRANS-FILE   ASSIGN TO TRANS                          00286039
 C19              FILE STATUS IS WS-TRANS-FILE-STATUS.                   00287039
       *** PROGRAM FILE NAME            JCL DDNAME ***************       00290002
        DATA DIVISION.                                                   00300002
        FILE SECTION.                                                    00310016
                                                                         00320002
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" *****************  00330002
        FD  DEPT-FILE                                                    00340002
            RECORD CONTAINS 80 CHARACTERS                                00350002
            BLOCK  CONTAINS  0 RECORDS                                   00360002
            RECORDING  MODE IS F.                                        00370002
        01  DEPT-REC         PIC X(80).                                  00380039
       * EMP-FILE DEFINITION                                             00380142
 C12    FD  EMP-FILE                                                     00381020
 C12        RECORD CONTAINS 80 CHARACTERS                                00382020
 C12        BLOCK  CONTAINS  0 RECORDS                                   00383020
 C12        RECORDING  MODE IS F.                                        00384020
 C12    01  EMP-REC          PIC X(80).                                  00385020
       * EMP-PRT-FILE DEFINITION                                         00385142
 C22    FD  EMP-PRT-FILE                                                 00385242
 C22        RECORD CONTAINS 133 CHARACTERS                               00385342
 C22        BLOCK  CONTAINS  0 RECORDS                                   00385442
 C22        RECORDING  MODE IS F.                                        00385542
 C22    01  EMP-PRT-REC      PIC X(133).                                 00385642
       * TRANS-FILE DEFINITION                                           00386243
 C19    FD  TRANS-FILE                                                   00386343
 C19        RECORD CONTAINS 80 CHARACTERS                                00387042
 C19        BLOCK  CONTAINS  0 RECORDS                                   00388042
 C19        RECORDING  MODE IS F.                                        00389042
 C19    01  TRANS-REC          PIC X(80).                                00389142
       ********* FD AND IT'S 01  ARE A "MATCHED PAIR" ****************** 00390002
                                                                         00400002
        WORKING-STORAGE SECTION.                                         00410002
       ********* WS - OUR DATA NAMES *******************                 00420002
        01  WS-DEPT-EOF          PIC X(03)     VALUE SPACES.             00430002
 C8     01  WS-DEPT-FILE-STATUS  PIC X(02).                              00431024
        01  WS-DEPT-REC.                                                 00440010
 C5       05  WS-DEPT-REC-DEPT-NUM         PIC X(3).                     00441010
 C5       05  WS-DEPT-REC-DEPT-NAME        PIC X(36).                    00442010
 C5       05  WS-DEPT-REC-MANAGER-NUM      PIC X(6).                     00443010
 C5       05  WS-DEPT-REC-ADMIN-CODE       PIC X(3).                     00444010
 C5       05                               PIC X(32).                    00445012
 C13    01  WS-EMP-EOF          PIC X(03)     VALUE SPACES.              00446029
 C13    01  WS-EMP-FILE-STATUS  PIC X(02).                               00447020
 C13    01  WS-EMP-REC.                                                  00448029
 C14      05  WS-EMP-REC-EMP-NUM         PIC X(6).                       00449020
 C14      05  WS-EMP-REC-LAST-NAME       PIC X(15).                      00449120
 C14      05  WS-EMP-REC-FIRST-NAME      PIC X(12).                      00449220
 C14      05  WS-EMP-REC-MID-IN          PIC X(1).                       00449320
 C14      05  WS-EMP-REC-DEPT-NUM        PIC X(3).                       00449420
 C14      05  WS-EMP-REC-JOB-TITLE       PIC X(11).                      00449520
1                                                                                                              PAGE 0085
 MEMBER NAME  COBSHEL
 C14      05  WS-EMP-REC-EMP-SAL         PIC 9(5)V99.                    00449642
 C14      05  WS-EMP-REC-EMP-BONUS       PIC 9(5)V99.                    00449742
 C14      05  WS-EMP-REC-EMP-COMM        PIC 9(5)V99.                    00449842
 C21    01  WS-EMP-SAL              PIC $ZZ,ZZ9.99.                      00449966
 C21    01  WS-EMP-BONUS            PIC $ZZ,ZZ9.99.                      00450066
 C21    01  WS-EMP-COMM             PIC $ZZ,ZZ9.99.                      00451066
 C22    01  WS-EMP-TOTAL-SALARY     PIC 9(7)V9(2).                       00451449
 C22    01  WS-EMP-PRT-LINE-COUNT    PIC 9(2)     VALUE 0.               00451551
 C22    01  WS-EMP-PRT-PAGE-COUNT    PIC 9(5)     VALUE 0.               00451651
 C22    01  WS-EMP-PRT-HDR1.                                             00451945
 C22      05  FILLER                PIC X(20)     VALUE SPACES.          00452048
 C22      05                        PIC X(22) VALUE '-ABC CONSULTING-'.  00452148
 C22      05                        PIC X(20)     VALUE SPACES.          00452248
 C22      05                        PIC X(10)     VALUE 'PAGE NO:'.      00452348
 C22      05  WS-EMP-PRT-HDR1-PAGE-COUNT  PIC ZZZZ9.                     00452445
 C22      05                        PIC X(21)     VALUE SPACES.          00452551
 C22    01  WS-EMP-PRT-HDR2.                                             00452845
 C23      05                         PIC X(05)      VALUE SPACES.        00453156
 C23      05                         PIC X(15) VALUE 'D E P T N U M .'.  00453256
 C22      05                         PIC X(05)      VALUE SPACES.        00453356
 C22      05                         PIC X(15) VALUE 'L A S T N A M E'.  00453456
 C22      05                         PIC X(05)      VALUE SPACES.        00453556
 C22      05                         PIC X(17)                           00453656
 C22                                         VALUE 'F I R S T N A M E'.  00453756
 C22      05                         PIC X(05)      VALUE SPACES.        00453856
 C22      05                         PIC X(05)                           00453956
 C22                                         VALUE 'M . I'.              00454056
 C22      05                         PIC X(61)     VALUE SPACES.         00454156
 C21    01  WS-EMP-PRT-REC.                                              00454242
 C21      05                             PIC X(05)     VALUE SPACES.     00454342
 C21      05  WS-EMP-PRT-DEPT-NUM        PIC X(15).                      00454456
 C21      05                             PIC X(05)     VALUE SPACES.     00454556
 C21      05  WS-EMP-PRT-LNAM            PIC X(15).                      00454656
 C21      05                             PIC X(05)     VALUE SPACES.     00454756
 C21      05  WS-EMP-PRT-FNAM            PIC X(17).                      00454856
 C21      05                             PIC X(07)     VALUE SPACES.     00454956
 C14      05  WS-EMP-PRT-MID-IN          PIC X(05).                      00455056
 C21      05                             PIC X(59)     VALUE SPACES.     00455156
 C22    01  WS-EMP-PRT-TOTAL-SALARY.                                     00455256
 C22      05                         PIC X(10)  VALUE SPACES.            00455356
 C22      05                         PIC X(20)  VALUE 'TOTAL SALARY='.   00455456
 C22      05                         PIC X(02)  VALUE SPACES.            00455556
       * CHANGE TO $$$$,$$$.99 IF NOT WORKING******************          00455656
 C22      05  WS-EMP-PRT-TOT-SALARY  PIC $$,$$$,$$$.99.                  00455756
 C22      05                         PIC X(90)  VALUE SPACES.            00455856
 C13    01  WS-TRANS-EOF             PIC X(03).                          00455956
 C13    01  WS-TRANS-FILE-STATUS     PIC X(02).                          00456056
 C13    01  WS-TRANS-REC.                                                00456156
 C14      05  WS-TRANS-REC-TRANS-ID           PIC X(2).                  00456256
 C14      05  WS-TRANS-REC-TRANS-NAME         PIC X(5).                  00456356
 C13    01  WS-PARM1                 PIC X(14).                          00456460
        LINKAGE SECTION.                                                 00457042
 C24   ** //RUN     EXEC PGM=COBSHEL,COND=(5,LT),PARM='2023-11-15'*****  00458060
 C24    01 LS-PARM-FROM-JCL.                                             00459060
 C24        05 LS-PARM-LENGTH        PIC S9(04)  COMP.                   00460060
 C24        05 LS-PARM-DATA-FROM-JCL PIC X(10).                          00461060
        PROCEDURE DIVISION USING LS-PARM-FROM-JCL.                       00470059
 C1         DISPLAY 'REGINALD TRAIN05'                                   00471064
1                                                                                                              PAGE 0086
 MEMBER NAME  COBSHEL
 C24        DISPLAY 'JCL PARMS FOLLOW ..........'                        00472060
 C24        DISPLAY 'LS-PARM-LENGHT=' LS-PARM-LENGTH                     00473060
 C24        DISPLAY 'LS-PARM-DATA-FROM-JCL=' LS-PARM-DATA-FROM-JCL       00474060
            .                                                            00475063
       ********* OUR WORKING CODE I.E. INSTRUCTIONS / COMMANDS ********* 00480002
        0000-MAIN.                                                       00490002
       ********* A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME ****00500002
            DISPLAY '0000-MAIN'                                          00510002
                                                                         00520002
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00530002
            PERFORM 1000-PROCESS-DEPT-FILE                               00540002
                                                                         00550002
            PERFORM 2000-PROCESS-EMP-FILE                                00551020
                                                                         00552020
            PERFORM 3000-PROCESS-TRANS-FILE                              00553029
                                                                         00554029
       ********* GOBACK - RETURN TO Z/OS ****************                00560002
            GOBACK                                                       00570002
            .                                                            00580002
                                                                         00590002
                                                                         00600002
        1000-PROCESS-DEPT-FILE.                                          00610002
       **********************************************************        00620002
       ***  OPEN THE DEPARTMENT FILE TO ALLOW FOR PROCESSING   **        00630002
       ***  PROCESS THE DEPARTMENT FILE IN THE 1000- PARAGRAPH **        00640002
       ***  CLOSE THE DEPARTMENT FILE WHEN THE PROCESSING IN   **        00650002
       ***      PARAGRAPH 1100- IS FINISHED                    **        00660002
       *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00670002
       **********************************************************        00680002
            DISPLAY '1000-PROCESS-DEPT-FILE'                             00690002
                                                                         00700002
       ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00710002
            OPEN INPUT DEPT-FILE                                         00720002
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00720125
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00720225
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00720425
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00720525
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00720625
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00720725
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00720825
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00721325
 C9             END-EVALUATE                                             00721425
 C4         DISPLAY '**** S-T-A-R-T OF DEPT FILE****'                    00721508
 C4         DISPLAY ' '                                                  00722008
       ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00730002
            MOVE SPACES  TO  WS-DEPT-EOF                                 00740002
                                                                         00750002
       ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00760002
            PERFORM 1100-PROCESS-DEPT-REC                                00770005
 C2                   UNTIL WS-DEPT-EOF  = 'END'                         00771006
                                                                         00780002
       ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00790002
            CLOSE DEPT-FILE                                              00800002
 C4         DISPLAY ' '                                                  00802008
 C4         DISPLAY '****  E-N-D OF DEPT FILE ****'                      00803009
 C9             EVALUATE WS-DEPT-FILE-STATUS                             00804025
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00805025
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00806025
1                                                                                                              PAGE 0087
 MEMBER NAME  COBSHEL
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00807025
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00808025
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00809025
 C9               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00809125
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00809225
 C9             END-EVALUATE                                             00809325
            .                                                            00810002
                                                                         00820002
        1100-PROCESS-DEPT-REC.                                           00830002
       **********************************************************        00840002
       ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00850002
       **********************************************************        00860002
 C3    *    DISPLAY '1100-PROCESS-DEPT-REC'                              00870006
                                                                         00880002
       ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00890002
       ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00900002
       *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00910002
       ********* NOT AT END OF FILE PROCESS THIS REC       **********    00920002
            READ DEPT-FILE INTO  WS-DEPT-REC                             00930002
                AT END      MOVE 'END' TO WS-DEPT-EOF                    00940002
                NOT AT END  PERFORM 1110-PROCESS-DEPT-FIELDS             00950025
            END-READ                                                     00960002
 C9         EVALUATE WS-DEPT-FILE-STATUS                                 00961025
 C9               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00962025
 C9               WHEN '04'          DISPLAY 'WRONG FILE'                00963025
 C9               WHEN '10'          DISPLAY 'END OF FILE'               00964025
 C9               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00965025
 C9               WHEN '35'          DISPLAY 'FILE MISSING'              00966025
 C9               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00967025
 C9               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    00969125
 C9               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   00969216
 C9               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00969416
 C9         END-EVALUATE                                                 00969525
            .                                                            00970002
        1110-PROCESS-DEPT-FIELDS.                                        00970125
       **********************************************************        00970225
       ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        00970326
       **********************************************************        00970425
            DISPLAY  '1110-PROCESS-DEPT-FIELDS'                          00970525
       **********************************************************        00970625
       ***= GOES AFTER NOT***************************************        00970726
       **********************************************************        00970826
       ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00970926
       **********************************************************        00971026
       ***END WITH "END-IF" STATEMENT****************************        00971126
       **********************************************************        00971226
       *******DISPLAY INDIVIDUAL FIELDS********************************  00971361
 C17        IF WS-DEPT-REC-DEPT-NAME NOT = SPACE                         00971426
 C17            DISPLAY 'WS-DEPT-REC ='                                  00971526
 C17                          WS-DEPT-REC                                00971626
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NAME='                         00971726
 C17                          WS-DEPT-REC-DEPT-NAME                      00971826
 C17            DISPLAY 'WS-DEPT-REC-DEPT-NUM='                          00971926
 C17                          WS-DEPT-REC-DEPT-NUM                       00972026
 C17            DISPLAY 'WS-DEPT-REC-MANAGER-NUM='                       00972125
 C17                          WS-DEPT-REC-MANAGER-NUM                    00972225
 C17            DISPLAY 'WS-DEPT-REC-ADMIN-CODE='                        00972325
 C17                          WS-DEPT-REC-ADMIN-CODE                     00972425
1                                                                                                              PAGE 0088
 MEMBER NAME  COBSHEL
            ELSE                                                         00972525
                DISPLAY 'BAD RECORD'                                     00972625
            END-IF                                                       00972725
            .                                                            00972825
 C15   **********************************************************        00972927
  V    *********************************************************         00973028
  |    **********************************************************        00973127
  |     2000-PROCESS-EMP-FILE.                                           00973227
  |    **********************************************************        00973327
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        00973427
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        00974027
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        00975027
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        00976027
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        00977027
  |    **********************************************************        00978028
  |         DISPLAY '2000-PROCESS-EMP-FILE'                              00979028
  |                                                                      00979122
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 00979222
            MOVE 0 TO WS-EMP-PRT-PAGE-COUNT                              00979347
            MOVE 50 TO WS-EMP-PRT-LINE-COUNT                             00979451
  |         OPEN INPUT EMP-FILE                                          00979542
  |             EVALUATE WS-EMP-FILE-STATUS                              00979642
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00979742
  |               WHEN '10'          DISPLAY 'END OF FILE'               00979842
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00979942
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00980042
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00980142
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00980242
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00980342
  |             END-EVALUATE                                             00980442
  |         DISPLAY '**** S-T-A-R-T OF EMP FILE****'                     00980542
  |         DISPLAY ' '                                                  00980642
       ********* USE OPEN OUTPUT TO READ A PRINT *********************** 00980765
 C22        OPEN OUTPUT EMP-PRT-FILE                                     00980851
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 00981742
  |         MOVE SPACES  TO  WS-EMP-EOF                                  00981842
  |                                                                      00981942
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 00982042
  |         PERFORM 2100-PROCESS-EMP-REC                                 00982142
  |                   UNTIL WS-EMP-EOF  = 'END'                          00982242
  |                                                                      00982342
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  00983022
  |         CLOSE EMP-FILE                                               00984042
  |             EVALUATE WS-EMP-FILE-STATUS                              00984142
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    00984242
  |               WHEN '10'          DISPLAY 'END OF FILE'               00984342
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           00984442
  |               WHEN '35'          DISPLAY 'FILE MISSING'              00984542
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        00984642
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      00984742
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        00984842
  |             END-EVALUATE                                             00984942
  |         DISPLAY ' '                                                  00985042
  |         DISPLAY '****  E-N-D OF EMP FILE ****'                       00986042
 C22        WRITE EMP-PRT-REC FROM WS-EMP-PRT-TOTAL-SALARY AFTER 2 LINES 00986151
 C22        CLOSE EMP-PRT-FILE                                           00986251
  _         .                                                            00988042
       ***********************************************************       00991342
1                                                                                                              PAGE 0089
 MEMBER NAME  COBSHEL
       ***********************************************************       00991442
       ***********************************************************       00991542
  |                                                                      00991642
  |     2100-PROCESS-EMP-REC.                                            00991742
  |    **********************************************************        00991842
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           00991942
  |    **********************************************************        00992042
  |    *    DISPLAY '2100-PROCESS-EMP-REC'                               00992142
  |                                                                      00992242
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    00992342
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 00992442
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 00992542
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    00992642
  |         READ EMP-FILE INTO  WS-EMP-REC                               00992742
  |             AT END      MOVE 'END' TO WS-EMP-EOF                     00992842
 C23            NOT AT END  DISPLAY 'WS-EMP-REC ='                       00993042
  V                                    WS-EMP-REC                        00993142
  |    **********************************************************        00993242
  |    ** = GOES AFTER NOT AND BEFORE SPACE *********************        00993342
  |    **********************************************************        00993442
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        00993542
  |    **********************************************************        00993642
  |    ***END WITH "END-IF" STATEMENT****************************        00993742
  |    **********************************************************        00993842
  |         IF WS-EMP-REC-LAST-NAME NOT = SPACE                          00994042
  |             DISPLAY 'WS-EMP-REC ='                                   00995042
  |                        WS-EMP-REC                                    00996042
  |             DISPLAY 'WS-EMP-REC-EMP-NUM='                            00997042
  |                        WS-EMP-REC-EMP-NUM                            00998042
  |             DISPLAY 'WS-EMP-REC-LAST-NAME='                          00999042
  |                        WS-EMP-REC-LAST-NAME                          00999142
  |             DISPLAY 'WS-EMP-REC-FIRST-NAME='                         00999242
  |                        WS-EMP-REC-FIRST-NAME                         00999342
  |             DISPLAY 'WS-EMP-REC-MID-IN='                             00999442
  |                        WS-EMP-REC-MID-IN                             00999542
  |             DISPLAY 'WS-EMP-REC-DEPT-NUM='                           00999642
  |                        WS-EMP-REC-DEPT-NUM                           00999742
  |             DISPLAY 'WS-EMP-REC-JOB-TITLE='                          00999842
  |                        WS-EMP-REC-JOB-TITLE                          00999942
  C21           MOVE    WS-EMP-REC-EMP-SAL TO WS-EMP-SAL                 01000642
  C21           DISPLAY WS-EMP-SAL                                       01000742
  C21           MOVE    WS-EMP-REC-EMP-BONUS TO WS-EMP-BONUS             01000842
  C21           DISPLAY WS-EMP-BONUS                                     01000942
  C21           MOVE    WS-EMP-REC-EMP-COMM TO WS-EMP-COMM               01001042
  C21           DISPLAY WS-EMP-COMM                                      01001142
  |             PERFORM 2110-MOVE-WRITE-EMP-REC                          01001262
  |         ELSE                                                         01001342
  |             DISPLAY 'BAD RECORD'                                     01001442
  >         END-IF                                                       01001542
  |         END-READ                                                     01001622
  |             EVALUATE WS-EMP-FILE-STATUS                              01001722
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01001822
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01001922
  |               WHEN '10'          DISPLAY 'END OF FILE'               01002022
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01002122
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01002222
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01002322
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01002422
1                                                                                                              PAGE 0090
 MEMBER NAME  COBSHEL
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01002522
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01003022
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01004022
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01005022
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01006022
  |             END-EVALUATE                                             01007028
  -         .                                                            01008028
 C22    2110-MOVE-WRITE-EMP-REC.                                         01008142
  V    **********************************************************        01008228
  |    ****PERFORMING MOVE AND WRIT STATED ABOVE****************         01008342
  |    **********************************************************        01008428
  |         DISPLAY  '2110-MOVE-WRITE-EMP-REC'                           01008542
  |         DISPLAY  WS-EMP-REC                                          01008642
  V    **********************************************************        01008742
  |    ****IF STATEMENTS FOR LINE COUNT**************************        01008842
  |    **********************************************************        01008942
 C22        IF   WS-EMP-PRT-LINE-COUNT > 11                              01009055
  |         THEN     PERFORM 2112-WRITE-PRT-EMP-HDRS                     01010055
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020055
  |         ELSE                                                         01020155
  |                  PERFORM 2111-MOVE-FLDS-WRITE-EMP-DTL                01020255
  |         END-IF                                                       01020355
  _         .                                                            01020441
 C22   ****************************************************************  01020555
  |    ****************************************************************  01020755
  |    ****************************************************************  01020855
  |     2111-MOVE-FLDS-WRITE-EMP-DTL.                                    01020955
  |         DISPLAY '2111-MOVE-FLDS-WRITE-EMP-DTL'                       01021055
  |         MOVE  WS-EMP-REC-LAST-NAME  TO WS-EMP-PRT-LNAM               01021155
  |         MOVE  WS-EMP-REC-DEPT-NUM   TO WS-EMP-PRT-DEPT-NUM           01021256
  |         MOVE  WS-EMP-REC-FIRST-NAME TO WS-EMP-PRT-FNAM               01021356
 C23        MOVE  WS-EMP-REC-MID-IN     TO WS-EMP-PRT-MID-IN             01021456
  |         ADD   WS-EMP-REC-EMP-SAL    TO WS-EMP-TOTAL-SALARY           01021556
  |         ADD      1                  TO WS-EMP-PRT-LINE-COUNT         01021656
  |         MOVE  WS-EMP-TOTAL-SALARY   TO WS-EMP-PRT-TOT-SALARY         01021756
  |         WRITE EMP-PRT-REC         FROM WS-EMP-PRT-REC AFTER 2 LINE   01021856
  |         .                                                            01022055
  |     2112-WRITE-PRT-EMP-HDRS.                                         01022155
  |         DISPLAY '2112-WRITE-PRT-EMP-HDRS'                            01022255
  |         ADD          1       TO WS-EMP-PRT-PAGE-COUNT                01022355
  |         MOVE   WS-EMP-PRT-PAGE-COUNT TO WS-EMP-PRT-HDR1-PAGE-COUNT   01022455
  |         MOVE         0       TO WS-EMP-PRT-LINE-COUNT                01022555
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR1 AFTER PAGE         01022655
  |         WRITE  EMP-PRT-REC   FROM WS-EMP-PRT-HDR2 AFTER 2 LINES      01022755
  _         .                                                            01022955
 C19   **********************************************************        01023044
  V    *************TRANS FILLE*********************************         01023144
  |    **********************************************************        01023244
  |     3000-PROCESS-TRANS-FILE.                                         01023344
  |    **********************************************************        01023444
  |    ***  OPEN THE EMPLOYEE FILE TO ALLOW FOR PROCESSING     **        01023544
  |    ***  PROCESS THE EMPLOYEE FILE IN THE 1000- PARAGRAPH   **        01023644
  |    ***  CLOSE THE EMPLOYEE FILE WHEN THE PROCESSING IN     **        01023744
  |    ***      PARAGRAPH 2100- IS FINISHED                    **        01024029
  |    *** A DISPLAY TO SHOW US WHERE WE ARE AT EXECUTION TIME **        01025029
  |    **********************************************************        01026029
  |         DISPLAY '3000-PROCESS-TRANS-FILE'                            01027029
  |                                                                      01028029
1                                                                                                              PAGE 0091
 MEMBER NAME  COBSHEL
  |    ********* OPEN - MAKE THE FILE AVAIALBLE FOR READING ************ 01029029
  |         OPEN INPUT TRANS-FILE                                        01029129
  |             EVALUATE WS-TRANS-FILE-STATUS                            01029229
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01029329
  |               WHEN '10'          DISPLAY 'END OF FILE'               01029429
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01029529
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01029629
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01029729
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01029829
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01029929
  |             END-EVALUATE                                             01030029
  |         DISPLAY '**** S-T-A-R-T OF TRANS FILE****'                   01031029
  |         DISPLAY ' '                                                  01032029
  |    ********* MOVE SPACES    RESET EOF (END-OF-FILE) INDICATOR ****** 01033029
  |         MOVE SPACES  TO  WS-TRANS-EOF                                01034029
  |                                                                      01035029
  |    ********* PERFORM - EXECUTE AND RETURN TO AFTER THE PERFORM ***** 01036029
  |         PERFORM 3100-PROCESS-TRANS-REC                               01037030
  |                   UNTIL WS-TRANS-EOF  = 'END'                        01038030
  |                                                                      01039029
  |    ********* CLOSE -  FILE IS NO LONGER AVAILABLE FOR READING *****  01039129
  |         CLOSE TRANS-FILE                                             01039230
  |             EVALUATE WS-TRANS-FILE-STATUS                            01039330
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01039429
  |               WHEN '10'          DISPLAY 'END OF FILE'               01039529
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01039629
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01039729
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01039829
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01039929
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01040029
  |             END-EVALUATE                                             01041029
  |         DISPLAY ' '                                                  01042029
  |         DISPLAY '****  E-N-D OF TRANS FILE ****'                     01043030
  |         .                                                            01044029
  |                                                                      01045029
  |     3100-PROCESS-TRANS-REC.                                          01046030
  |    **********************************************************        01047029
  |    ********  READ ONE REC FROM THE DEPARTMENT FILE  ******           01048029
  |    **********************************************************        01049029
  |    *    DISPLAY '3100-PROCESS-TRANS-REC'                             01049130
  |                                                                      01049229
  |    ********* READ   MOVE A REC FROM Z/OS TO THE PROGRAM *********    01049329
  |    ********* AT END OF FILE (I.E. NO MORE INPUT RECRDS    ********** 01049429
  |    *********     MOVE 'END' TO INDICATE END OF FILE FOR PROGRAM **** 01049529
  |    ********* NOT AT END OF FILE PROCESS THIS REC       **********    01049629
  |         READ TRANS-FILE INTO  WS-TRANS-REC                           01049730
  |             AT END      MOVE 'END' TO WS-TRANS-EOF                   01049830
  |             NOT AT END  PERFORM 3110-PROCESS-TRANS-FIELDS            01049930
  |         END-READ                                                     01050029
  |             EVALUATE WS-TRANS-FILE-STATUS                            01051030
  |               WHEN '00'          DISPLAY 'SUCESSFUL READ TO FILE'    01052029
  |               WHEN '04'          DISPLAY 'WRONG FILE'                01053029
  |               WHEN '10'          DISPLAY 'END OF FILE'               01054029
  |               WHEN '30'          DISPLAY 'PERMENANT ERROR'           01055029
  |               WHEN '35'          DISPLAY 'FILE MISSING'              01056029
  |               WHEN '39'          DISPLAY 'ATTRIBUTE MISMATCH'        01057029
  |               WHEN '41'          DISPLAY 'OPEN OF AN OPEN FILE'      01058029
  |               WHEN '42'          DISPLAY 'CLOSE OF A CLOSED FILE'    01059029
1                                                                                                              PAGE 0092
 MEMBER NAME  COBSHEL
  |               WHEN '46'          DISPLAY 'READ AFTER END OF FILE'    01059129
  |               WHEN '47'          DISPLAY 'READ WITHOUT OPEN INPUT'   01059229
  |               WHEN '48'          DISPLAY 'WRITE WITHOUT OPEN OUTPUT' 01059329
  |               WHEN OTHER         DISPLAY 'NON ZERO STATUS OF'        01059429
  |             END-EVALUATE                                             01059529
  -         .                                                            01059629
 C19    3110-PROCESS-TRANS-FIELDS.                                       01059732
  V    **********************************************************        01059829
  |    ****PERFORMING NOT AT END READ FOR READ STATEMENT ABOVE***        01059929
  |    **********************************************************        01060029
  |    *    DISPLAY  '3110-PROCESS-TRANS-FIELDS'                         01061037
  |    **********************************************************        01062029
  |    ***= GOES AFTER NOT***************************************        01063029
  |    **********************************************************        01064029
  |    ***PUT ALL DISPLAYS BEFORE ELSE STATEMENT*****************        01065029
  |    **********************************************************        01066029
  |    ***END WITH "END-IF" STATEMENT****************************        01067029
  |    **********************************************************        01068029
  |    *    IF WS-TRANS-REC-TRANS-ID NOT = SPACE                         01069035
  |    *        DISPLAY 'WS-TRAS-REC ='                                  01069135
  |    *                   WS-TRANS-REC                                  01069235
  |    *        DISPLAY 'WS-TRANS-REC-TRANS-ID='                         01069335
  |    *                   WS-TRANS-REC-TRANS-ID                         01069435
  |    *        DISPLAY 'WS-EMP-REC-TRANS-NAME='                         01069535
  |    *                   WS-TRANS-REC-TRANS-NAME                       01069635
  |    **   ELSE                                                         01079235
  |    *        DISPLAY 'INVALAD RECORD'                                 01079335
  |    *    END-IF                                                       01079435
 C20        EVALUATE WS-TRANS-REC-TRANS-ID                               01079535
  |           WHEN SPACE          DISPLAY  'INVALAD TRANS'               01079637
  |           WHEN OTHER          DISPLAY 'WS-TRAS-REC ='                01079737
  |                                          WS-TRANS-REC                01079837
  |                               DISPLAY 'WS-TRANS-REC-TRANS-ID='       01079937
  |                                          WS-TRANS-REC-TRANS-ID       01080037
  |                               DISPLAY 'WS-EMP-REC-TRANS-NAME='       01080137
  |                                          WS-TRANS-REC-TRANS-NAME     01080237
  _         .                                                            01081037
       ********  END OF PROGRAM    COBSHEL ***********************       01090037
